[2025-12-23 01:34:25] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:34:25] Loading datasets ...
[2025-12-23 01:34:52] Building Transformer model ...
[2025-12-23 01:36:12] [Epoch 1] train loss = 5.8564
[2025-12-23 01:36:15] [Epoch 1] valid BLEU-4 = 2.86
[2025-12-23 01:36:16] [Checkpoint] Saved best model (BLEU=2.86) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:37:31] [Epoch 2] train loss = 5.2458
[2025-12-23 01:37:34] [Epoch 2] valid BLEU-4 = 2.84
[2025-12-23 01:38:46] [Epoch 3] train loss = 4.9293
[2025-12-23 01:38:49] [Epoch 3] valid BLEU-4 = 4.46
[2025-12-23 01:38:49] [Checkpoint] Saved best model (BLEU=4.46) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:40:04] [Epoch 4] train loss = 4.6914
[2025-12-23 01:40:07] [Epoch 4] valid BLEU-4 = 5.17
[2025-12-23 01:40:07] [Checkpoint] Saved best model (BLEU=5.17) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:41:22] [Epoch 5] train loss = 4.5026
[2025-12-23 01:41:25] [Epoch 5] valid BLEU-4 = 5.66
[2025-12-23 01:41:25] [Checkpoint] Saved best model (BLEU=5.66) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:42:40] [Epoch 6] train loss = 4.3481
[2025-12-23 01:42:43] [Epoch 6] valid BLEU-4 = 6.89
[2025-12-23 01:42:44] [Checkpoint] Saved best model (BLEU=6.89) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:43:58] [Epoch 7] train loss = 4.2210
[2025-12-23 01:44:00] [Epoch 7] valid BLEU-4 = 6.31
[2025-12-23 01:45:15] [Epoch 8] train loss = 4.1147
[2025-12-23 01:45:18] [Epoch 8] valid BLEU-4 = 7.30
[2025-12-23 01:45:18] [Checkpoint] Saved best model (BLEU=7.30) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:46:32] [Epoch 9] train loss = 4.0238
[2025-12-23 01:46:35] [Epoch 9] valid BLEU-4 = 7.25
[2025-12-23 01:47:48] [Epoch 10] train loss = 3.9462
[2025-12-23 01:47:51] [Epoch 10] valid BLEU-4 = 7.65
[2025-12-23 01:47:51] [Checkpoint] Saved best model (BLEU=7.65) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:49:04] [Epoch 11] train loss = 3.8776
[2025-12-23 01:49:07] [Epoch 11] valid BLEU-4 = 8.17
[2025-12-23 01:49:08] [Checkpoint] Saved best model (BLEU=8.17) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:50:22] [Epoch 12] train loss = 3.8205
[2025-12-23 01:50:24] [Epoch 12] valid BLEU-4 = 8.49
[2025-12-23 01:50:25] [Checkpoint] Saved best model (BLEU=8.49) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:51:38] [Epoch 13] train loss = 3.7682
[2025-12-23 01:51:41] [Epoch 13] valid BLEU-4 = 8.80
[2025-12-23 01:51:41] [Checkpoint] Saved best model (BLEU=8.80) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:52:54] [Epoch 14] train loss = 3.7208
[2025-12-23 01:52:56] [Epoch 14] valid BLEU-4 = 9.04
[2025-12-23 01:52:57] [Checkpoint] Saved best model (BLEU=9.04) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:54:09] [Epoch 15] train loss = 3.6775
[2025-12-23 01:54:12] [Epoch 15] valid BLEU-4 = 9.41
[2025-12-23 01:54:12] [Checkpoint] Saved best model (BLEU=9.41) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:55:26] [Epoch 16] train loss = 3.6388
[2025-12-23 01:55:29] [Epoch 16] valid BLEU-4 = 9.81
[2025-12-23 01:55:29] [Checkpoint] Saved best model (BLEU=9.81) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:56:43] [Epoch 17] train loss = 3.6031
[2025-12-23 01:56:45] [Epoch 17] valid BLEU-4 = 9.51
[2025-12-23 01:57:59] [Epoch 18] train loss = 3.5710
[2025-12-23 01:58:02] [Epoch 18] valid BLEU-4 = 9.84
[2025-12-23 01:58:02] [Checkpoint] Saved best model (BLEU=9.84) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 01:59:16] [Epoch 19] train loss = 3.5414
[2025-12-23 01:59:18] [Epoch 19] valid BLEU-4 = 9.81
[2025-12-23 02:00:33] [Epoch 20] train loss = 3.5127
[2025-12-23 02:00:36] [Epoch 20] valid BLEU-4 = 10.50
[2025-12-23 02:00:36] [Checkpoint] Saved best model (BLEU=10.50) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:01:49] [Epoch 21] train loss = 3.4874
[2025-12-23 02:01:52] [Epoch 21] valid BLEU-4 = 10.53
[2025-12-23 02:01:52] [Checkpoint] Saved best model (BLEU=10.53) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:03:07] [Epoch 22] train loss = 3.4622
[2025-12-23 02:03:10] [Epoch 22] valid BLEU-4 = 10.52
[2025-12-23 02:04:22] [Epoch 23] train loss = 3.4399
[2025-12-23 02:04:25] [Epoch 23] valid BLEU-4 = 10.66
[2025-12-23 02:04:25] [Checkpoint] Saved best model (BLEU=10.66) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:05:40] [Epoch 24] train loss = 3.4185
[2025-12-23 02:05:42] [Epoch 24] valid BLEU-4 = 10.72
[2025-12-23 02:05:42] [Checkpoint] Saved best model (BLEU=10.72) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:06:56] [Epoch 25] train loss = 3.3998
[2025-12-23 02:06:58] [Epoch 25] valid BLEU-4 = 10.77
[2025-12-23 02:06:59] [Checkpoint] Saved best model (BLEU=10.77) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:08:13] [Epoch 26] train loss = 3.3804
[2025-12-23 02:08:16] [Epoch 26] valid BLEU-4 = 10.88
[2025-12-23 02:08:16] [Checkpoint] Saved best model (BLEU=10.88) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:09:28] [Epoch 27] train loss = 3.3630
[2025-12-23 02:09:31] [Epoch 27] valid BLEU-4 = 11.60
[2025-12-23 02:09:31] [Checkpoint] Saved best model (BLEU=11.60) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:10:45] [Epoch 28] train loss = 3.3459
[2025-12-23 02:10:47] [Epoch 28] valid BLEU-4 = 10.93
[2025-12-23 02:12:01] [Epoch 29] train loss = 3.3300
[2025-12-23 02:12:04] [Epoch 29] valid BLEU-4 = 11.35
[2025-12-23 02:13:16] [Epoch 30] train loss = 3.3146
[2025-12-23 02:13:19] [Epoch 30] valid BLEU-4 = 11.28
[2025-12-23 02:14:32] [Epoch 31] train loss = 3.3003
[2025-12-23 02:14:35] [Epoch 31] valid BLEU-4 = 11.48
[2025-12-23 02:15:49] [Epoch 32] train loss = 3.2870
[2025-12-23 02:15:52] [Epoch 32] valid BLEU-4 = 12.14
[2025-12-23 02:15:52] [Checkpoint] Saved best model (BLEU=12.14) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:17:07] [Epoch 33] train loss = 3.2737
[2025-12-23 02:17:09] [Epoch 33] valid BLEU-4 = 11.42
[2025-12-23 02:18:22] [Epoch 34] train loss = 3.2623
[2025-12-23 02:18:25] [Epoch 34] valid BLEU-4 = 11.75
[2025-12-23 02:19:40] [Epoch 35] train loss = 3.2502
[2025-12-23 02:19:42] [Epoch 35] valid BLEU-4 = 12.40
[2025-12-23 02:19:43] [Checkpoint] Saved best model (BLEU=12.40) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:20:57] [Epoch 36] train loss = 3.2386
[2025-12-23 02:20:59] [Epoch 36] valid BLEU-4 = 12.03
[2025-12-23 02:22:13] [Epoch 37] train loss = 3.2277
[2025-12-23 02:22:16] [Epoch 37] valid BLEU-4 = 11.83
[2025-12-23 02:23:29] [Epoch 38] train loss = 3.2168
[2025-12-23 02:23:33] [Epoch 38] valid BLEU-4 = 11.87
[2025-12-23 02:24:51] [Epoch 39] train loss = 3.2074
[2025-12-23 02:24:54] [Epoch 39] valid BLEU-4 = 12.11
[2025-12-23 02:26:07] [Epoch 40] train loss = 3.1970
[2025-12-23 02:26:09] [Epoch 40] valid BLEU-4 = 11.30
[2025-12-23 02:27:24] [Epoch 41] train loss = 3.1871
[2025-12-23 02:27:26] [Epoch 41] valid BLEU-4 = 11.71
[2025-12-23 02:28:40] [Epoch 42] train loss = 3.1783
[2025-12-23 02:28:43] [Epoch 42] valid BLEU-4 = 11.54
[2025-12-23 02:29:56] [Epoch 43] train loss = 3.1692
[2025-12-23 02:29:59] [Epoch 43] valid BLEU-4 = 11.33
[2025-12-23 02:31:14] [Epoch 44] train loss = 3.1614
[2025-12-23 02:31:17] [Epoch 44] valid BLEU-4 = 11.85
[2025-12-23 02:32:31] [Epoch 45] train loss = 3.1534
[2025-12-23 02:32:34] [Epoch 45] valid BLEU-4 = 12.35
[2025-12-23 02:33:46] [Epoch 46] train loss = 3.1452
[2025-12-23 02:33:49] [Epoch 46] valid BLEU-4 = 12.41
[2025-12-23 02:33:49] [Checkpoint] Saved best model (BLEU=12.41) to ./checkpoints_trans/transformer_zh_en_best_exp_bs32.pt
[2025-12-23 02:35:03] [Epoch 47] train loss = 3.1375
[2025-12-23 02:35:06] [Epoch 47] valid BLEU-4 = 12.01
[2025-12-23 02:36:20] [Epoch 48] train loss = 3.1294
[2025-12-23 02:36:23] [Epoch 48] valid BLEU-4 = 12.10
[2025-12-23 02:37:36] [Epoch 49] train loss = 3.1228
[2025-12-23 02:37:39] [Epoch 49] valid BLEU-4 = 11.89
[2025-12-23 02:38:51] [Epoch 50] train loss = 3.1162
[2025-12-23 02:38:54] [Epoch 50] valid BLEU-4 = 12.40
[2025-12-23 02:38:54] Loading best checkpoint for test ...
