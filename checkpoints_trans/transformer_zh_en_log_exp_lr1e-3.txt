[2025-12-23 01:37:11] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:37:11] Loading datasets ...
[2025-12-23 01:37:38] Building Transformer model ...
[2025-12-23 01:38:23] [Epoch 1] train loss = 5.5176
[2025-12-23 01:38:25] [Epoch 1] valid BLEU-4 = 1.74
[2025-12-23 01:38:26] [Checkpoint] Saved best model (BLEU=1.74) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:39:06] [Epoch 2] train loss = 4.8158
[2025-12-23 01:39:08] [Epoch 2] valid BLEU-4 = 4.47
[2025-12-23 01:39:08] [Checkpoint] Saved best model (BLEU=4.47) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:39:49] [Epoch 3] train loss = 4.4068
[2025-12-23 01:39:51] [Epoch 3] valid BLEU-4 = 5.38
[2025-12-23 01:39:51] [Checkpoint] Saved best model (BLEU=5.38) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:40:31] [Epoch 4] train loss = 4.1680
[2025-12-23 01:40:33] [Epoch 4] valid BLEU-4 = 7.04
[2025-12-23 01:40:33] [Checkpoint] Saved best model (BLEU=7.04) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:41:14] [Epoch 5] train loss = 4.0146
[2025-12-23 01:41:16] [Epoch 5] valid BLEU-4 = 8.16
[2025-12-23 01:41:16] [Checkpoint] Saved best model (BLEU=8.16) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:41:57] [Epoch 6] train loss = 3.9055
[2025-12-23 01:41:58] [Epoch 6] valid BLEU-4 = 7.96
[2025-12-23 01:42:40] [Epoch 7] train loss = 3.8242
[2025-12-23 01:42:42] [Epoch 7] valid BLEU-4 = 9.68
[2025-12-23 01:42:42] [Checkpoint] Saved best model (BLEU=9.68) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:43:22] [Epoch 8] train loss = 3.7609
[2025-12-23 01:43:24] [Epoch 8] valid BLEU-4 = 9.95
[2025-12-23 01:43:24] [Checkpoint] Saved best model (BLEU=9.95) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:44:05] [Epoch 9] train loss = 3.7088
[2025-12-23 01:44:06] [Epoch 9] valid BLEU-4 = 9.91
[2025-12-23 01:44:47] [Epoch 10] train loss = 3.6667
[2025-12-23 01:44:48] [Epoch 10] valid BLEU-4 = 9.78
[2025-12-23 01:45:28] [Epoch 11] train loss = 3.6325
[2025-12-23 01:45:30] [Epoch 11] valid BLEU-4 = 10.28
[2025-12-23 01:45:30] [Checkpoint] Saved best model (BLEU=10.28) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:46:09] [Epoch 12] train loss = 3.5985
[2025-12-23 01:46:11] [Epoch 12] valid BLEU-4 = 9.88
[2025-12-23 01:46:51] [Epoch 13] train loss = 3.5724
[2025-12-23 01:46:53] [Epoch 13] valid BLEU-4 = 10.31
[2025-12-23 01:46:53] [Checkpoint] Saved best model (BLEU=10.31) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:47:34] [Epoch 14] train loss = 3.5481
[2025-12-23 01:47:35] [Epoch 14] valid BLEU-4 = 9.81
[2025-12-23 01:48:15] [Epoch 15] train loss = 3.5262
[2025-12-23 01:48:17] [Epoch 15] valid BLEU-4 = 10.21
[2025-12-23 01:48:57] [Epoch 16] train loss = 3.5064
[2025-12-23 01:48:58] [Epoch 16] valid BLEU-4 = 10.06
[2025-12-23 01:49:39] [Epoch 17] train loss = 3.4900
[2025-12-23 01:49:41] [Epoch 17] valid BLEU-4 = 10.84
[2025-12-23 01:49:41] [Checkpoint] Saved best model (BLEU=10.84) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:50:21] [Epoch 18] train loss = 3.4726
[2025-12-23 01:50:23] [Epoch 18] valid BLEU-4 = 10.39
[2025-12-23 01:51:03] [Epoch 19] train loss = 3.4574
[2025-12-23 01:51:05] [Epoch 19] valid BLEU-4 = 11.52
[2025-12-23 01:51:05] [Checkpoint] Saved best model (BLEU=11.52) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:51:46] [Epoch 20] train loss = 3.4449
[2025-12-23 01:51:47] [Epoch 20] valid BLEU-4 = 10.48
[2025-12-23 01:52:27] [Epoch 21] train loss = 3.4324
[2025-12-23 01:52:29] [Epoch 21] valid BLEU-4 = 10.80
[2025-12-23 01:53:09] [Epoch 22] train loss = 3.4182
[2025-12-23 01:53:10] [Epoch 22] valid BLEU-4 = 9.98
[2025-12-23 01:53:50] [Epoch 23] train loss = 3.4072
[2025-12-23 01:53:51] [Epoch 23] valid BLEU-4 = 11.92
[2025-12-23 01:53:52] [Checkpoint] Saved best model (BLEU=11.92) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 01:54:32] [Epoch 24] train loss = 3.3973
[2025-12-23 01:54:33] [Epoch 24] valid BLEU-4 = 11.06
[2025-12-23 01:55:14] [Epoch 25] train loss = 3.3866
[2025-12-23 01:55:15] [Epoch 25] valid BLEU-4 = 10.68
[2025-12-23 01:55:56] [Epoch 26] train loss = 3.3775
[2025-12-23 01:55:57] [Epoch 26] valid BLEU-4 = 10.89
[2025-12-23 01:56:38] [Epoch 27] train loss = 3.3706
[2025-12-23 01:56:39] [Epoch 27] valid BLEU-4 = 10.56
[2025-12-23 01:57:20] [Epoch 28] train loss = 3.3595
[2025-12-23 01:57:22] [Epoch 28] valid BLEU-4 = 10.47
[2025-12-23 01:58:02] [Epoch 29] train loss = 3.3521
[2025-12-23 01:58:03] [Epoch 29] valid BLEU-4 = 10.29
[2025-12-23 01:58:43] [Epoch 30] train loss = 3.3458
[2025-12-23 01:58:45] [Epoch 30] valid BLEU-4 = 11.32
[2025-12-23 01:59:25] [Epoch 31] train loss = 3.3388
[2025-12-23 01:59:26] [Epoch 31] valid BLEU-4 = 11.37
[2025-12-23 02:00:06] [Epoch 32] train loss = 3.3314
[2025-12-23 02:00:08] [Epoch 32] valid BLEU-4 = 11.25
[2025-12-23 02:00:48] [Epoch 33] train loss = 3.3238
[2025-12-23 02:00:50] [Epoch 33] valid BLEU-4 = 10.94
[2025-12-23 02:01:30] [Epoch 34] train loss = 3.3170
[2025-12-23 02:01:32] [Epoch 34] valid BLEU-4 = 11.26
[2025-12-23 02:02:12] [Epoch 35] train loss = 3.3119
[2025-12-23 02:02:13] [Epoch 35] valid BLEU-4 = 11.56
[2025-12-23 02:02:54] [Epoch 36] train loss = 3.3069
[2025-12-23 02:02:55] [Epoch 36] valid BLEU-4 = 11.49
[2025-12-23 02:03:36] [Epoch 37] train loss = 3.2996
[2025-12-23 02:03:38] [Epoch 37] valid BLEU-4 = 11.28
[2025-12-23 02:04:18] [Epoch 38] train loss = 3.2934
[2025-12-23 02:04:20] [Epoch 38] valid BLEU-4 = 11.60
[2025-12-23 02:05:01] [Epoch 39] train loss = 3.2887
[2025-12-23 02:05:02] [Epoch 39] valid BLEU-4 = 11.18
[2025-12-23 02:05:42] [Epoch 40] train loss = 3.2825
[2025-12-23 02:05:44] [Epoch 40] valid BLEU-4 = 11.16
[2025-12-23 02:06:24] [Epoch 41] train loss = 3.2789
[2025-12-23 02:06:25] [Epoch 41] valid BLEU-4 = 11.57
[2025-12-23 02:07:06] [Epoch 42] train loss = 3.2737
[2025-12-23 02:07:08] [Epoch 42] valid BLEU-4 = 11.35
[2025-12-23 02:07:48] [Epoch 43] train loss = 3.2690
[2025-12-23 02:07:50] [Epoch 43] valid BLEU-4 = 10.98
[2025-12-23 02:08:30] [Epoch 44] train loss = 3.2630
[2025-12-23 02:08:32] [Epoch 44] valid BLEU-4 = 11.69
[2025-12-23 02:09:12] [Epoch 45] train loss = 3.2600
[2025-12-23 02:09:14] [Epoch 45] valid BLEU-4 = 11.99
[2025-12-23 02:09:14] [Checkpoint] Saved best model (BLEU=11.99) to ./checkpoints_trans/transformer_zh_en_best_exp_lr1e-3.pt
[2025-12-23 02:09:54] [Epoch 46] train loss = 3.2545
[2025-12-23 02:09:56] [Epoch 46] valid BLEU-4 = 11.59
[2025-12-23 02:10:35] [Epoch 47] train loss = 3.2515
[2025-12-23 02:10:37] [Epoch 47] valid BLEU-4 = 11.97
[2025-12-23 02:11:17] [Epoch 48] train loss = 3.2469
[2025-12-23 02:11:18] [Epoch 48] valid BLEU-4 = 11.04
[2025-12-23 02:11:58] [Epoch 49] train loss = 3.2419
[2025-12-23 02:12:00] [Epoch 49] valid BLEU-4 = 11.19
[2025-12-23 02:12:40] [Epoch 50] train loss = 3.2373
[2025-12-23 02:12:42] [Epoch 50] valid BLEU-4 = 11.73
[2025-12-23 02:12:42] Loading best checkpoint for test ...
