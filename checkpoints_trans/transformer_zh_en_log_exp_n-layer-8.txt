[2025-12-23 01:39:56] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:39:56] Loading datasets ...
[2025-12-23 01:40:23] Building Transformer model ...
[2025-12-23 01:41:51] [Epoch 1] train loss = 5.9438
[2025-12-23 01:41:54] [Epoch 1] valid BLEU-4 = 2.72
[2025-12-23 01:41:54] [Checkpoint] Saved best model (BLEU=2.72) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:43:16] [Epoch 2] train loss = 5.2963
[2025-12-23 01:43:19] [Epoch 2] valid BLEU-4 = 3.70
[2025-12-23 01:43:19] [Checkpoint] Saved best model (BLEU=3.70) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:44:40] [Epoch 3] train loss = 4.9610
[2025-12-23 01:44:44] [Epoch 3] valid BLEU-4 = 4.72
[2025-12-23 01:44:44] [Checkpoint] Saved best model (BLEU=4.72) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:46:05] [Epoch 4] train loss = 4.7090
[2025-12-23 01:46:08] [Epoch 4] valid BLEU-4 = 5.09
[2025-12-23 01:46:09] [Checkpoint] Saved best model (BLEU=5.09) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:47:30] [Epoch 5] train loss = 4.5056
[2025-12-23 01:47:33] [Epoch 5] valid BLEU-4 = 6.09
[2025-12-23 01:47:34] [Checkpoint] Saved best model (BLEU=6.09) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:48:55] [Epoch 6] train loss = 4.3366
[2025-12-23 01:48:58] [Epoch 6] valid BLEU-4 = 5.92
[2025-12-23 01:50:21] [Epoch 7] train loss = 4.1954
[2025-12-23 01:50:24] [Epoch 7] valid BLEU-4 = 7.01
[2025-12-23 01:50:24] [Checkpoint] Saved best model (BLEU=7.01) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:51:46] [Epoch 8] train loss = 4.0742
[2025-12-23 01:51:49] [Epoch 8] valid BLEU-4 = 7.39
[2025-12-23 01:51:49] [Checkpoint] Saved best model (BLEU=7.39) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:53:10] [Epoch 9] train loss = 3.9706
[2025-12-23 01:53:13] [Epoch 9] valid BLEU-4 = 7.95
[2025-12-23 01:53:13] [Checkpoint] Saved best model (BLEU=7.95) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:54:34] [Epoch 10] train loss = 3.8806
[2025-12-23 01:54:37] [Epoch 10] valid BLEU-4 = 8.63
[2025-12-23 01:54:38] [Checkpoint] Saved best model (BLEU=8.63) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:55:59] [Epoch 11] train loss = 3.8016
[2025-12-23 01:56:02] [Epoch 11] valid BLEU-4 = 9.33
[2025-12-23 01:56:03] [Checkpoint] Saved best model (BLEU=9.33) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 01:57:27] [Epoch 12] train loss = 3.7306
[2025-12-23 01:57:30] [Epoch 12] valid BLEU-4 = 9.14
[2025-12-23 01:58:52] [Epoch 13] train loss = 3.6681
[2025-12-23 01:58:56] [Epoch 13] valid BLEU-4 = 9.86
[2025-12-23 01:58:56] [Checkpoint] Saved best model (BLEU=9.86) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:00:18] [Epoch 14] train loss = 3.6122
[2025-12-23 02:00:22] [Epoch 14] valid BLEU-4 = 10.34
[2025-12-23 02:00:23] [Checkpoint] Saved best model (BLEU=10.34) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:01:45] [Epoch 15] train loss = 3.5622
[2025-12-23 02:01:48] [Epoch 15] valid BLEU-4 = 9.97
[2025-12-23 02:03:09] [Epoch 16] train loss = 3.5155
[2025-12-23 02:03:12] [Epoch 16] valid BLEU-4 = 10.14
[2025-12-23 02:04:35] [Epoch 17] train loss = 3.4731
[2025-12-23 02:04:38] [Epoch 17] valid BLEU-4 = 11.07
[2025-12-23 02:04:38] [Checkpoint] Saved best model (BLEU=11.07) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:06:01] [Epoch 18] train loss = 3.4336
[2025-12-23 02:06:03] [Epoch 18] valid BLEU-4 = 10.43
[2025-12-23 02:07:26] [Epoch 19] train loss = 3.3971
[2025-12-23 02:07:29] [Epoch 19] valid BLEU-4 = 11.13
[2025-12-23 02:07:29] [Checkpoint] Saved best model (BLEU=11.13) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:08:53] [Epoch 20] train loss = 3.3645
[2025-12-23 02:08:55] [Epoch 20] valid BLEU-4 = 10.87
[2025-12-23 02:10:18] [Epoch 21] train loss = 3.3324
[2025-12-23 02:10:21] [Epoch 21] valid BLEU-4 = 11.03
[2025-12-23 02:11:42] [Epoch 22] train loss = 3.3034
[2025-12-23 02:11:45] [Epoch 22] valid BLEU-4 = 11.33
[2025-12-23 02:11:45] [Checkpoint] Saved best model (BLEU=11.33) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:13:07] [Epoch 23] train loss = 3.2758
[2025-12-23 02:13:10] [Epoch 23] valid BLEU-4 = 10.92
[2025-12-23 02:14:32] [Epoch 24] train loss = 3.2504
[2025-12-23 02:14:35] [Epoch 24] valid BLEU-4 = 11.21
[2025-12-23 02:15:57] [Epoch 25] train loss = 3.2264
[2025-12-23 02:16:00] [Epoch 25] valid BLEU-4 = 11.97
[2025-12-23 02:16:00] [Checkpoint] Saved best model (BLEU=11.97) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:17:22] [Epoch 26] train loss = 3.2034
[2025-12-23 02:17:25] [Epoch 26] valid BLEU-4 = 11.34
[2025-12-23 02:18:47] [Epoch 27] train loss = 3.1821
[2025-12-23 02:18:50] [Epoch 27] valid BLEU-4 = 11.23
[2025-12-23 02:20:11] [Epoch 28] train loss = 3.1613
[2025-12-23 02:20:14] [Epoch 28] valid BLEU-4 = 11.55
[2025-12-23 02:21:36] [Epoch 29] train loss = 3.1412
[2025-12-23 02:21:39] [Epoch 29] valid BLEU-4 = 11.93
[2025-12-23 02:23:01] [Epoch 30] train loss = 3.1223
[2025-12-23 02:23:04] [Epoch 30] valid BLEU-4 = 11.81
[2025-12-23 02:24:25] [Epoch 31] train loss = 3.1044
[2025-12-23 02:24:28] [Epoch 31] valid BLEU-4 = 11.93
[2025-12-23 02:25:49] [Epoch 32] train loss = 3.0875
[2025-12-23 02:25:52] [Epoch 32] valid BLEU-4 = 12.38
[2025-12-23 02:25:53] [Checkpoint] Saved best model (BLEU=12.38) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:27:15] [Epoch 33] train loss = 3.0705
[2025-12-23 02:27:18] [Epoch 33] valid BLEU-4 = 11.66
[2025-12-23 02:28:40] [Epoch 34] train loss = 3.0551
[2025-12-23 02:28:43] [Epoch 34] valid BLEU-4 = 12.38
[2025-12-23 02:30:04] [Epoch 35] train loss = 3.0389
[2025-12-23 02:30:07] [Epoch 35] valid BLEU-4 = 12.04
[2025-12-23 02:31:30] [Epoch 36] train loss = 3.0254
[2025-12-23 02:31:33] [Epoch 36] valid BLEU-4 = 12.36
[2025-12-23 02:32:55] [Epoch 37] train loss = 3.0112
[2025-12-23 02:32:58] [Epoch 37] valid BLEU-4 = 12.39
[2025-12-23 02:32:58] [Checkpoint] Saved best model (BLEU=12.39) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:34:21] [Epoch 38] train loss = 2.9968
[2025-12-23 02:34:23] [Epoch 38] valid BLEU-4 = 12.68
[2025-12-23 02:34:24] [Checkpoint] Saved best model (BLEU=12.68) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:35:45] [Epoch 39] train loss = 2.9839
[2025-12-23 02:35:48] [Epoch 39] valid BLEU-4 = 12.63
[2025-12-23 02:37:10] [Epoch 40] train loss = 2.9710
[2025-12-23 02:37:13] [Epoch 40] valid BLEU-4 = 12.68
[2025-12-23 02:37:13] [Checkpoint] Saved best model (BLEU=12.68) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:38:34] [Epoch 41] train loss = 2.9587
[2025-12-23 02:38:37] [Epoch 41] valid BLEU-4 = 12.73
[2025-12-23 02:38:38] [Checkpoint] Saved best model (BLEU=12.73) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:39:59] [Epoch 42] train loss = 2.9474
[2025-12-23 02:40:02] [Epoch 42] valid BLEU-4 = 12.94
[2025-12-23 02:40:02] [Checkpoint] Saved best model (BLEU=12.94) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:41:24] [Epoch 43] train loss = 2.9368
[2025-12-23 02:41:28] [Epoch 43] valid BLEU-4 = 12.26
[2025-12-23 02:42:50] [Epoch 44] train loss = 2.9247
[2025-12-23 02:42:53] [Epoch 44] valid BLEU-4 = 12.30
[2025-12-23 02:44:15] [Epoch 45] train loss = 2.9135
[2025-12-23 02:44:18] [Epoch 45] valid BLEU-4 = 12.70
[2025-12-23 02:45:42] [Epoch 46] train loss = 2.9034
[2025-12-23 02:45:45] [Epoch 46] valid BLEU-4 = 13.04
[2025-12-23 02:45:45] [Checkpoint] Saved best model (BLEU=13.04) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:47:06] [Epoch 47] train loss = 2.8935
[2025-12-23 02:47:09] [Epoch 47] valid BLEU-4 = 12.69
[2025-12-23 02:48:30] [Epoch 48] train loss = 2.8844
[2025-12-23 02:48:33] [Epoch 48] valid BLEU-4 = 13.27
[2025-12-23 02:48:34] [Checkpoint] Saved best model (BLEU=13.27) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-8.pt
[2025-12-23 02:49:55] [Epoch 49] train loss = 2.8739
[2025-12-23 02:49:58] [Epoch 49] valid BLEU-4 = 13.05
[2025-12-23 02:51:20] [Epoch 50] train loss = 2.8635
[2025-12-23 02:51:23] [Epoch 50] valid BLEU-4 = 12.68
[2025-12-23 02:51:23] Loading best checkpoint for test ...
