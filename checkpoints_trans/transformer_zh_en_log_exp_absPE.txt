[2025-12-23 01:22:09] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:22:09] Loading datasets ...
[2025-12-23 01:22:35] Building Transformer model ...
[2025-12-23 01:23:12] [Epoch 1] train loss = 5.9994
[2025-12-23 01:23:13] [Epoch 1] valid BLEU-4 = 1.97
[2025-12-23 01:23:14] [Checkpoint] Saved best model (BLEU=1.97) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:23:45] [Epoch 2] train loss = 5.4255
[2025-12-23 01:23:46] [Epoch 2] valid BLEU-4 = 2.78
[2025-12-23 01:23:47] [Checkpoint] Saved best model (BLEU=2.78) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:24:18] [Epoch 3] train loss = 5.1677
[2025-12-23 01:24:19] [Epoch 3] valid BLEU-4 = 3.03
[2025-12-23 01:24:20] [Checkpoint] Saved best model (BLEU=3.03) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:24:52] [Epoch 4] train loss = 4.9832
[2025-12-23 01:24:53] [Epoch 4] valid BLEU-4 = 3.27
[2025-12-23 01:24:54] [Checkpoint] Saved best model (BLEU=3.27) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:25:25] [Epoch 5] train loss = 4.8374
[2025-12-23 01:25:26] [Epoch 5] valid BLEU-4 = 3.93
[2025-12-23 01:25:26] [Checkpoint] Saved best model (BLEU=3.93) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:26:14] [Epoch 6] train loss = 4.7176
[2025-12-23 01:26:17] [Epoch 6] valid BLEU-4 = 3.91
[2025-12-23 01:27:04] [Epoch 7] train loss = 4.6178
[2025-12-23 01:27:06] [Epoch 7] valid BLEU-4 = 4.55
[2025-12-23 01:27:06] [Checkpoint] Saved best model (BLEU=4.55) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:27:54] [Epoch 8] train loss = 4.5312
[2025-12-23 01:27:55] [Epoch 8] valid BLEU-4 = 4.86
[2025-12-23 01:27:55] [Checkpoint] Saved best model (BLEU=4.86) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:28:43] [Epoch 9] train loss = 4.4559
[2025-12-23 01:28:44] [Epoch 9] valid BLEU-4 = 4.90
[2025-12-23 01:28:45] [Checkpoint] Saved best model (BLEU=4.90) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:29:31] [Epoch 10] train loss = 4.3894
[2025-12-23 01:29:33] [Epoch 10] valid BLEU-4 = 5.19
[2025-12-23 01:29:33] [Checkpoint] Saved best model (BLEU=5.19) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:30:21] [Epoch 11] train loss = 4.3301
[2025-12-23 01:30:23] [Epoch 11] valid BLEU-4 = 5.72
[2025-12-23 01:30:23] [Checkpoint] Saved best model (BLEU=5.72) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:31:10] [Epoch 12] train loss = 4.2745
[2025-12-23 01:31:12] [Epoch 12] valid BLEU-4 = 5.88
[2025-12-23 01:31:12] [Checkpoint] Saved best model (BLEU=5.88) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:31:59] [Epoch 13] train loss = 4.2264
[2025-12-23 01:32:01] [Epoch 13] valid BLEU-4 = 5.78
[2025-12-23 01:32:48] [Epoch 14] train loss = 4.1812
[2025-12-23 01:32:49] [Epoch 14] valid BLEU-4 = 5.41
[2025-12-23 01:33:36] [Epoch 15] train loss = 4.1400
[2025-12-23 01:33:38] [Epoch 15] valid BLEU-4 = 5.93
[2025-12-23 01:33:38] [Checkpoint] Saved best model (BLEU=5.93) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:34:26] [Epoch 16] train loss = 4.1004
[2025-12-23 01:34:27] [Epoch 16] valid BLEU-4 = 5.68
[2025-12-23 01:35:14] [Epoch 17] train loss = 4.0646
[2025-12-23 01:35:16] [Epoch 17] valid BLEU-4 = 6.43
[2025-12-23 01:35:16] [Checkpoint] Saved best model (BLEU=6.43) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:36:02] [Epoch 18] train loss = 4.0320
[2025-12-23 01:36:04] [Epoch 18] valid BLEU-4 = 6.31
[2025-12-23 01:36:51] [Epoch 19] train loss = 4.0014
[2025-12-23 01:36:53] [Epoch 19] valid BLEU-4 = 6.40
[2025-12-23 01:37:40] [Epoch 20] train loss = 3.9730
[2025-12-23 01:37:42] [Epoch 20] valid BLEU-4 = 6.00
[2025-12-23 01:38:29] [Epoch 21] train loss = 3.9452
[2025-12-23 01:38:31] [Epoch 21] valid BLEU-4 = 6.27
[2025-12-23 01:39:17] [Epoch 22] train loss = 3.9197
[2025-12-23 01:39:19] [Epoch 22] valid BLEU-4 = 6.24
[2025-12-23 01:40:06] [Epoch 23] train loss = 3.8962
[2025-12-23 01:40:07] [Epoch 23] valid BLEU-4 = 6.95
[2025-12-23 01:40:07] [Checkpoint] Saved best model (BLEU=6.95) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:40:55] [Epoch 24] train loss = 3.8708
[2025-12-23 01:40:57] [Epoch 24] valid BLEU-4 = 6.91
[2025-12-23 01:41:43] [Epoch 25] train loss = 3.8507
[2025-12-23 01:41:45] [Epoch 25] valid BLEU-4 = 6.61
[2025-12-23 01:42:31] [Epoch 26] train loss = 3.8299
[2025-12-23 01:42:33] [Epoch 26] valid BLEU-4 = 7.02
[2025-12-23 01:42:33] [Checkpoint] Saved best model (BLEU=7.02) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:43:20] [Epoch 27] train loss = 3.8112
[2025-12-23 01:43:22] [Epoch 27] valid BLEU-4 = 7.07
[2025-12-23 01:43:22] [Checkpoint] Saved best model (BLEU=7.07) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:44:09] [Epoch 28] train loss = 3.7911
[2025-12-23 01:44:11] [Epoch 28] valid BLEU-4 = 6.75
[2025-12-23 01:44:57] [Epoch 29] train loss = 3.7741
[2025-12-23 01:44:59] [Epoch 29] valid BLEU-4 = 6.61
[2025-12-23 01:45:46] [Epoch 30] train loss = 3.7570
[2025-12-23 01:45:48] [Epoch 30] valid BLEU-4 = 7.05
[2025-12-23 01:46:35] [Epoch 31] train loss = 3.7412
[2025-12-23 01:46:37] [Epoch 31] valid BLEU-4 = 7.35
[2025-12-23 01:46:37] [Checkpoint] Saved best model (BLEU=7.35) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:47:23] [Epoch 32] train loss = 3.7252
[2025-12-23 01:47:25] [Epoch 32] valid BLEU-4 = 6.67
[2025-12-23 01:48:13] [Epoch 33] train loss = 3.7107
[2025-12-23 01:48:14] [Epoch 33] valid BLEU-4 = 7.17
[2025-12-23 01:49:02] [Epoch 34] train loss = 3.6957
[2025-12-23 01:49:04] [Epoch 34] valid BLEU-4 = 7.11
[2025-12-23 01:49:51] [Epoch 35] train loss = 3.6819
[2025-12-23 01:49:53] [Epoch 35] valid BLEU-4 = 6.73
[2025-12-23 01:50:40] [Epoch 36] train loss = 3.6687
[2025-12-23 01:50:42] [Epoch 36] valid BLEU-4 = 7.26
[2025-12-23 01:51:29] [Epoch 37] train loss = 3.6560
[2025-12-23 01:51:31] [Epoch 37] valid BLEU-4 = 7.18
[2025-12-23 01:52:20] [Epoch 38] train loss = 3.6440
[2025-12-23 01:52:21] [Epoch 38] valid BLEU-4 = 6.74
[2025-12-23 01:53:09] [Epoch 39] train loss = 3.6310
[2025-12-23 01:53:11] [Epoch 39] valid BLEU-4 = 7.36
[2025-12-23 01:53:12] [Checkpoint] Saved best model (BLEU=7.36) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:54:00] [Epoch 40] train loss = 3.6197
[2025-12-23 01:54:02] [Epoch 40] valid BLEU-4 = 6.85
[2025-12-23 01:54:50] [Epoch 41] train loss = 3.6088
[2025-12-23 01:54:52] [Epoch 41] valid BLEU-4 = 6.92
[2025-12-23 01:55:40] [Epoch 42] train loss = 3.5971
[2025-12-23 01:55:42] [Epoch 42] valid BLEU-4 = 7.22
[2025-12-23 01:56:29] [Epoch 43] train loss = 3.5880
[2025-12-23 01:56:31] [Epoch 43] valid BLEU-4 = 6.86
[2025-12-23 01:57:19] [Epoch 44] train loss = 3.5771
[2025-12-23 01:57:21] [Epoch 44] valid BLEU-4 = 7.24
[2025-12-23 01:58:08] [Epoch 45] train loss = 3.5674
[2025-12-23 01:58:10] [Epoch 45] valid BLEU-4 = 7.48
[2025-12-23 01:58:10] [Checkpoint] Saved best model (BLEU=7.48) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 01:58:57] [Epoch 46] train loss = 3.5578
[2025-12-23 01:58:59] [Epoch 46] valid BLEU-4 = 7.05
[2025-12-23 01:59:46] [Epoch 47] train loss = 3.5491
[2025-12-23 01:59:48] [Epoch 47] valid BLEU-4 = 7.50
[2025-12-23 01:59:49] [Checkpoint] Saved best model (BLEU=7.50) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 02:00:37] [Epoch 48] train loss = 3.5399
[2025-12-23 02:00:39] [Epoch 48] valid BLEU-4 = 7.58
[2025-12-23 02:00:39] [Checkpoint] Saved best model (BLEU=7.58) to ./checkpoints_trans/transformer_zh_en_best_exp_absPE.pt
[2025-12-23 02:01:27] [Epoch 49] train loss = 3.5313
[2025-12-23 02:01:29] [Epoch 49] valid BLEU-4 = 7.02
[2025-12-23 02:02:15] [Epoch 50] train loss = 3.5231
[2025-12-23 02:02:17] [Epoch 50] valid BLEU-4 = 7.17
[2025-12-23 02:02:17] Loading best checkpoint for test ...
