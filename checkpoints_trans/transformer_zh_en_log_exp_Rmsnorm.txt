[2025-12-23 01:32:30] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:32:30] Loading datasets ...
[2025-12-23 01:32:59] Building Transformer model ...
[2025-12-23 01:33:55] [Epoch 1] train loss = 5.9887
[2025-12-23 01:33:57] [Epoch 1] valid BLEU-4 = 2.42
[2025-12-23 01:33:57] [Checkpoint] Saved best model (BLEU=2.42) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:34:42] [Epoch 2] train loss = 5.3841
[2025-12-23 01:34:44] [Epoch 2] valid BLEU-4 = 3.14
[2025-12-23 01:34:44] [Checkpoint] Saved best model (BLEU=3.14) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:35:26] [Epoch 3] train loss = 5.0946
[2025-12-23 01:35:28] [Epoch 3] valid BLEU-4 = 4.07
[2025-12-23 01:35:28] [Checkpoint] Saved best model (BLEU=4.07) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:36:09] [Epoch 4] train loss = 4.8794
[2025-12-23 01:36:11] [Epoch 4] valid BLEU-4 = 4.39
[2025-12-23 01:36:11] [Checkpoint] Saved best model (BLEU=4.39) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:36:55] [Epoch 5] train loss = 4.7027
[2025-12-23 01:36:57] [Epoch 5] valid BLEU-4 = 5.31
[2025-12-23 01:36:57] [Checkpoint] Saved best model (BLEU=5.31) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:37:43] [Epoch 6] train loss = 4.5555
[2025-12-23 01:37:45] [Epoch 6] valid BLEU-4 = 5.86
[2025-12-23 01:37:45] [Checkpoint] Saved best model (BLEU=5.86) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:38:35] [Epoch 7] train loss = 4.4286
[2025-12-23 01:38:37] [Epoch 7] valid BLEU-4 = 5.49
[2025-12-23 01:39:25] [Epoch 8] train loss = 4.3189
[2025-12-23 01:39:26] [Epoch 8] valid BLEU-4 = 6.12
[2025-12-23 01:39:27] [Checkpoint] Saved best model (BLEU=6.12) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:40:14] [Epoch 9] train loss = 4.2238
[2025-12-23 01:40:16] [Epoch 9] valid BLEU-4 = 6.13
[2025-12-23 01:40:17] [Checkpoint] Saved best model (BLEU=6.13) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:41:07] [Epoch 10] train loss = 4.1419
[2025-12-23 01:41:08] [Epoch 10] valid BLEU-4 = 6.20
[2025-12-23 01:41:09] [Checkpoint] Saved best model (BLEU=6.20) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:41:57] [Epoch 11] train loss = 4.0693
[2025-12-23 01:41:58] [Epoch 11] valid BLEU-4 = 6.89
[2025-12-23 01:41:59] [Checkpoint] Saved best model (BLEU=6.89) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:42:46] [Epoch 12] train loss = 4.0043
[2025-12-23 01:42:48] [Epoch 12] valid BLEU-4 = 7.37
[2025-12-23 01:42:48] [Checkpoint] Saved best model (BLEU=7.37) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:43:35] [Epoch 13] train loss = 3.9467
[2025-12-23 01:43:37] [Epoch 13] valid BLEU-4 = 7.62
[2025-12-23 01:43:37] [Checkpoint] Saved best model (BLEU=7.62) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:44:26] [Epoch 14] train loss = 3.8962
[2025-12-23 01:44:28] [Epoch 14] valid BLEU-4 = 8.39
[2025-12-23 01:44:28] [Checkpoint] Saved best model (BLEU=8.39) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:45:17] [Epoch 15] train loss = 3.8487
[2025-12-23 01:45:19] [Epoch 15] valid BLEU-4 = 7.85
[2025-12-23 01:46:08] [Epoch 16] train loss = 3.8058
[2025-12-23 01:46:10] [Epoch 16] valid BLEU-4 = 8.22
[2025-12-23 01:47:02] [Epoch 17] train loss = 3.7673
[2025-12-23 01:47:04] [Epoch 17] valid BLEU-4 = 8.78
[2025-12-23 01:47:04] [Checkpoint] Saved best model (BLEU=8.78) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:47:55] [Epoch 18] train loss = 3.7300
[2025-12-23 01:47:57] [Epoch 18] valid BLEU-4 = 7.88
[2025-12-23 01:48:48] [Epoch 19] train loss = 3.6980
[2025-12-23 01:48:50] [Epoch 19] valid BLEU-4 = 8.71
[2025-12-23 01:49:40] [Epoch 20] train loss = 3.6661
[2025-12-23 01:49:42] [Epoch 20] valid BLEU-4 = 9.07
[2025-12-23 01:49:42] [Checkpoint] Saved best model (BLEU=9.07) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:50:31] [Epoch 21] train loss = 3.6371
[2025-12-23 01:50:33] [Epoch 21] valid BLEU-4 = 9.36
[2025-12-23 01:50:33] [Checkpoint] Saved best model (BLEU=9.36) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:51:17] [Epoch 22] train loss = 3.6104
[2025-12-23 01:51:19] [Epoch 22] valid BLEU-4 = 8.83
[2025-12-23 01:52:03] [Epoch 23] train loss = 3.5844
[2025-12-23 01:52:05] [Epoch 23] valid BLEU-4 = 9.55
[2025-12-23 01:52:05] [Checkpoint] Saved best model (BLEU=9.55) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:52:52] [Epoch 24] train loss = 3.5608
[2025-12-23 01:52:54] [Epoch 24] valid BLEU-4 = 9.58
[2025-12-23 01:52:55] [Checkpoint] Saved best model (BLEU=9.58) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:53:35] [Epoch 25] train loss = 3.5387
[2025-12-23 01:53:37] [Epoch 25] valid BLEU-4 = 9.99
[2025-12-23 01:53:37] [Checkpoint] Saved best model (BLEU=9.99) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:54:22] [Epoch 26] train loss = 3.5176
[2025-12-23 01:54:24] [Epoch 26] valid BLEU-4 = 10.23
[2025-12-23 01:54:24] [Checkpoint] Saved best model (BLEU=10.23) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:55:06] [Epoch 27] train loss = 3.4961
[2025-12-23 01:55:07] [Epoch 27] valid BLEU-4 = 9.80
[2025-12-23 01:55:49] [Epoch 28] train loss = 3.4761
[2025-12-23 01:55:50] [Epoch 28] valid BLEU-4 = 9.97
[2025-12-23 01:56:35] [Epoch 29] train loss = 3.4584
[2025-12-23 01:56:37] [Epoch 29] valid BLEU-4 = 9.55
[2025-12-23 01:57:21] [Epoch 30] train loss = 3.4406
[2025-12-23 01:57:22] [Epoch 30] valid BLEU-4 = 9.64
[2025-12-23 01:58:05] [Epoch 31] train loss = 3.4248
[2025-12-23 01:58:06] [Epoch 31] valid BLEU-4 = 10.04
[2025-12-23 01:58:48] [Epoch 32] train loss = 3.4083
[2025-12-23 01:58:49] [Epoch 32] valid BLEU-4 = 10.23
[2025-12-23 01:58:50] [Checkpoint] Saved best model (BLEU=10.23) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 01:59:34] [Epoch 33] train loss = 3.3926
[2025-12-23 01:59:36] [Epoch 33] valid BLEU-4 = 10.25
[2025-12-23 01:59:36] [Checkpoint] Saved best model (BLEU=10.25) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 02:00:24] [Epoch 34] train loss = 3.3786
[2025-12-23 02:00:26] [Epoch 34] valid BLEU-4 = 10.50
[2025-12-23 02:00:26] [Checkpoint] Saved best model (BLEU=10.50) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 02:01:09] [Epoch 35] train loss = 3.3637
[2025-12-23 02:01:11] [Epoch 35] valid BLEU-4 = 10.37
[2025-12-23 02:01:55] [Epoch 36] train loss = 3.3507
[2025-12-23 02:01:57] [Epoch 36] valid BLEU-4 = 10.84
[2025-12-23 02:01:57] [Checkpoint] Saved best model (BLEU=10.84) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 02:02:42] [Epoch 37] train loss = 3.3376
[2025-12-23 02:02:44] [Epoch 37] valid BLEU-4 = 10.53
[2025-12-23 02:03:27] [Epoch 38] train loss = 3.3241
[2025-12-23 02:03:28] [Epoch 38] valid BLEU-4 = 10.63
[2025-12-23 02:04:15] [Epoch 39] train loss = 3.3126
[2025-12-23 02:04:17] [Epoch 39] valid BLEU-4 = 10.81
[2025-12-23 02:05:03] [Epoch 40] train loss = 3.3020
[2025-12-23 02:05:04] [Epoch 40] valid BLEU-4 = 10.44
[2025-12-23 02:05:50] [Epoch 41] train loss = 3.2912
[2025-12-23 02:05:52] [Epoch 41] valid BLEU-4 = 10.51
[2025-12-23 02:06:39] [Epoch 42] train loss = 3.2789
[2025-12-23 02:06:41] [Epoch 42] valid BLEU-4 = 11.29
[2025-12-23 02:06:42] [Checkpoint] Saved best model (BLEU=11.29) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 02:07:25] [Epoch 43] train loss = 3.2693
[2025-12-23 02:07:27] [Epoch 43] valid BLEU-4 = 11.06
[2025-12-23 02:08:11] [Epoch 44] train loss = 3.2583
[2025-12-23 02:08:13] [Epoch 44] valid BLEU-4 = 11.10
[2025-12-23 02:08:58] [Epoch 45] train loss = 3.2491
[2025-12-23 02:09:00] [Epoch 45] valid BLEU-4 = 11.14
[2025-12-23 02:09:45] [Epoch 46] train loss = 3.2393
[2025-12-23 02:09:47] [Epoch 46] valid BLEU-4 = 11.07
[2025-12-23 02:10:32] [Epoch 47] train loss = 3.2302
[2025-12-23 02:10:34] [Epoch 47] valid BLEU-4 = 11.47
[2025-12-23 02:10:34] [Checkpoint] Saved best model (BLEU=11.47) to ./checkpoints_trans/transformer_zh_en_best_exp_Rmsnorm.pt
[2025-12-23 02:11:18] [Epoch 48] train loss = 3.2214
[2025-12-23 02:11:20] [Epoch 48] valid BLEU-4 = 11.20
[2025-12-23 02:12:08] [Epoch 49] train loss = 3.2129
[2025-12-23 02:12:10] [Epoch 49] valid BLEU-4 = 10.90
[2025-12-23 02:12:59] [Epoch 50] train loss = 3.2054
[2025-12-23 02:13:01] [Epoch 50] valid BLEU-4 = 11.42
[2025-12-23 02:13:01] Loading best checkpoint for test ...
