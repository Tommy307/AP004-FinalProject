[2025-12-23 01:39:43] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:39:43] Loading datasets ...
[2025-12-23 01:40:10] Building Transformer model ...
[2025-12-23 01:40:39] [Epoch 1] train loss = 6.1112
[2025-12-23 01:40:41] [Epoch 1] valid BLEU-4 = 0.81
[2025-12-23 01:40:41] [Checkpoint] Saved best model (BLEU=0.81) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:41:04] [Epoch 2] train loss = 5.5772
[2025-12-23 01:41:06] [Epoch 2] valid BLEU-4 = 1.00
[2025-12-23 01:41:06] [Checkpoint] Saved best model (BLEU=1.00) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:41:29] [Epoch 3] train loss = 5.3366
[2025-12-23 01:41:30] [Epoch 3] valid BLEU-4 = 1.11
[2025-12-23 01:41:31] [Checkpoint] Saved best model (BLEU=1.11) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:41:53] [Epoch 4] train loss = 5.1633
[2025-12-23 01:41:55] [Epoch 4] valid BLEU-4 = 1.71
[2025-12-23 01:41:55] [Checkpoint] Saved best model (BLEU=1.71) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:42:18] [Epoch 5] train loss = 5.0258
[2025-12-23 01:42:19] [Epoch 5] valid BLEU-4 = 1.84
[2025-12-23 01:42:20] [Checkpoint] Saved best model (BLEU=1.84) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:42:42] [Epoch 6] train loss = 4.9105
[2025-12-23 01:42:44] [Epoch 6] valid BLEU-4 = 2.12
[2025-12-23 01:42:44] [Checkpoint] Saved best model (BLEU=2.12) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:43:08] [Epoch 7] train loss = 4.8121
[2025-12-23 01:43:09] [Epoch 7] valid BLEU-4 = 2.23
[2025-12-23 01:43:09] [Checkpoint] Saved best model (BLEU=2.23) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:43:33] [Epoch 8] train loss = 4.7259
[2025-12-23 01:43:34] [Epoch 8] valid BLEU-4 = 2.80
[2025-12-23 01:43:34] [Checkpoint] Saved best model (BLEU=2.80) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:43:57] [Epoch 9] train loss = 4.6480
[2025-12-23 01:43:59] [Epoch 9] valid BLEU-4 = 3.70
[2025-12-23 01:43:59] [Checkpoint] Saved best model (BLEU=3.70) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:44:22] [Epoch 10] train loss = 4.5779
[2025-12-23 01:44:23] [Epoch 10] valid BLEU-4 = 3.41
[2025-12-23 01:44:46] [Epoch 11] train loss = 4.5121
[2025-12-23 01:44:48] [Epoch 11] valid BLEU-4 = 3.39
[2025-12-23 01:45:10] [Epoch 12] train loss = 4.4529
[2025-12-23 01:45:12] [Epoch 12] valid BLEU-4 = 4.17
[2025-12-23 01:45:12] [Checkpoint] Saved best model (BLEU=4.17) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:45:34] [Epoch 13] train loss = 4.3982
[2025-12-23 01:45:36] [Epoch 13] valid BLEU-4 = 3.95
[2025-12-23 01:45:59] [Epoch 14] train loss = 4.3481
[2025-12-23 01:46:00] [Epoch 14] valid BLEU-4 = 4.86
[2025-12-23 01:46:00] [Checkpoint] Saved best model (BLEU=4.86) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:46:23] [Epoch 15] train loss = 4.3015
[2025-12-23 01:46:24] [Epoch 15] valid BLEU-4 = 5.07
[2025-12-23 01:46:25] [Checkpoint] Saved best model (BLEU=5.07) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:46:47] [Epoch 16] train loss = 4.2589
[2025-12-23 01:46:49] [Epoch 16] valid BLEU-4 = 5.24
[2025-12-23 01:46:49] [Checkpoint] Saved best model (BLEU=5.24) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:47:12] [Epoch 17] train loss = 4.2198
[2025-12-23 01:47:13] [Epoch 17] valid BLEU-4 = 6.06
[2025-12-23 01:47:13] [Checkpoint] Saved best model (BLEU=6.06) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:47:36] [Epoch 18] train loss = 4.1841
[2025-12-23 01:47:37] [Epoch 18] valid BLEU-4 = 5.91
[2025-12-23 01:48:00] [Epoch 19] train loss = 4.1511
[2025-12-23 01:48:01] [Epoch 19] valid BLEU-4 = 5.87
[2025-12-23 01:48:24] [Epoch 20] train loss = 4.1218
[2025-12-23 01:48:25] [Epoch 20] valid BLEU-4 = 6.62
[2025-12-23 01:48:26] [Checkpoint] Saved best model (BLEU=6.62) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:48:48] [Epoch 21] train loss = 4.0931
[2025-12-23 01:48:50] [Epoch 21] valid BLEU-4 = 6.29
[2025-12-23 01:49:12] [Epoch 22] train loss = 4.0667
[2025-12-23 01:49:14] [Epoch 22] valid BLEU-4 = 6.87
[2025-12-23 01:49:14] [Checkpoint] Saved best model (BLEU=6.87) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:49:36] [Epoch 23] train loss = 4.0431
[2025-12-23 01:49:38] [Epoch 23] valid BLEU-4 = 7.69
[2025-12-23 01:49:38] [Checkpoint] Saved best model (BLEU=7.69) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:50:00] [Epoch 24] train loss = 4.0198
[2025-12-23 01:50:02] [Epoch 24] valid BLEU-4 = 7.06
[2025-12-23 01:50:25] [Epoch 25] train loss = 3.9978
[2025-12-23 01:50:26] [Epoch 25] valid BLEU-4 = 7.14
[2025-12-23 01:50:49] [Epoch 26] train loss = 3.9789
[2025-12-23 01:50:50] [Epoch 26] valid BLEU-4 = 7.29
[2025-12-23 01:51:13] [Epoch 27] train loss = 3.9598
[2025-12-23 01:51:14] [Epoch 27] valid BLEU-4 = 7.64
[2025-12-23 01:51:37] [Epoch 28] train loss = 3.9423
[2025-12-23 01:51:38] [Epoch 28] valid BLEU-4 = 7.65
[2025-12-23 01:52:01] [Epoch 29] train loss = 3.9246
[2025-12-23 01:52:03] [Epoch 29] valid BLEU-4 = 7.75
[2025-12-23 01:52:03] [Checkpoint] Saved best model (BLEU=7.75) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:52:26] [Epoch 30] train loss = 3.9095
[2025-12-23 01:52:27] [Epoch 30] valid BLEU-4 = 7.65
[2025-12-23 01:52:49] [Epoch 31] train loss = 3.8947
[2025-12-23 01:52:51] [Epoch 31] valid BLEU-4 = 7.80
[2025-12-23 01:52:51] [Checkpoint] Saved best model (BLEU=7.80) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:53:14] [Epoch 32] train loss = 3.8803
[2025-12-23 01:53:15] [Epoch 32] valid BLEU-4 = 7.72
[2025-12-23 01:53:38] [Epoch 33] train loss = 3.8662
[2025-12-23 01:53:39] [Epoch 33] valid BLEU-4 = 7.71
[2025-12-23 01:54:01] [Epoch 34] train loss = 3.8544
[2025-12-23 01:54:03] [Epoch 34] valid BLEU-4 = 8.13
[2025-12-23 01:54:03] [Checkpoint] Saved best model (BLEU=8.13) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:54:26] [Epoch 35] train loss = 3.8416
[2025-12-23 01:54:27] [Epoch 35] valid BLEU-4 = 7.94
[2025-12-23 01:54:50] [Epoch 36] train loss = 3.8307
[2025-12-23 01:54:52] [Epoch 36] valid BLEU-4 = 8.15
[2025-12-23 01:54:52] [Checkpoint] Saved best model (BLEU=8.15) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:55:14] [Epoch 37] train loss = 3.8176
[2025-12-23 01:55:16] [Epoch 37] valid BLEU-4 = 7.86
[2025-12-23 01:55:38] [Epoch 38] train loss = 3.8066
[2025-12-23 01:55:39] [Epoch 38] valid BLEU-4 = 8.25
[2025-12-23 01:55:40] [Checkpoint] Saved best model (BLEU=8.25) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:56:02] [Epoch 39] train loss = 3.7974
[2025-12-23 01:56:04] [Epoch 39] valid BLEU-4 = 8.23
[2025-12-23 01:56:26] [Epoch 40] train loss = 3.7860
[2025-12-23 01:56:28] [Epoch 40] valid BLEU-4 = 8.25
[2025-12-23 01:56:28] [Checkpoint] Saved best model (BLEU=8.25) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:56:51] [Epoch 41] train loss = 3.7773
[2025-12-23 01:56:52] [Epoch 41] valid BLEU-4 = 8.05
[2025-12-23 01:57:14] [Epoch 42] train loss = 3.7672
[2025-12-23 01:57:16] [Epoch 42] valid BLEU-4 = 8.77
[2025-12-23 01:57:16] [Checkpoint] Saved best model (BLEU=8.77) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:57:39] [Epoch 43] train loss = 3.7579
[2025-12-23 01:57:40] [Epoch 43] valid BLEU-4 = 8.75
[2025-12-23 01:58:03] [Epoch 44] train loss = 3.7494
[2025-12-23 01:58:04] [Epoch 44] valid BLEU-4 = 8.83
[2025-12-23 01:58:04] [Checkpoint] Saved best model (BLEU=8.83) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 01:58:27] [Epoch 45] train loss = 3.7412
[2025-12-23 01:58:28] [Epoch 45] valid BLEU-4 = 8.48
[2025-12-23 01:58:51] [Epoch 46] train loss = 3.7328
[2025-12-23 01:58:52] [Epoch 46] valid BLEU-4 = 8.28
[2025-12-23 01:59:15] [Epoch 47] train loss = 3.7248
[2025-12-23 01:59:16] [Epoch 47] valid BLEU-4 = 8.80
[2025-12-23 01:59:38] [Epoch 48] train loss = 3.7177
[2025-12-23 01:59:40] [Epoch 48] valid BLEU-4 = 8.95
[2025-12-23 01:59:40] [Checkpoint] Saved best model (BLEU=8.95) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 02:00:03] [Epoch 49] train loss = 3.7095
[2025-12-23 02:00:04] [Epoch 49] valid BLEU-4 = 8.79
[2025-12-23 02:00:27] [Epoch 50] train loss = 3.7026
[2025-12-23 02:00:29] [Epoch 50] valid BLEU-4 = 8.96
[2025-12-23 02:00:29] [Checkpoint] Saved best model (BLEU=8.96) to ./checkpoints_trans/transformer_zh_en_best_exp_n-layer-2.pt
[2025-12-23 02:00:29] Loading best checkpoint for test ...
