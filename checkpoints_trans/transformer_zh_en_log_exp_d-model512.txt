[2025-12-23 01:38:55] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:38:55] Loading datasets ...
[2025-12-23 01:39:21] Building Transformer model ...
[2025-12-23 01:40:06] [Epoch 1] train loss = 5.7337
[2025-12-23 01:40:08] [Epoch 1] valid BLEU-4 = 3.14
[2025-12-23 01:40:09] [Checkpoint] Saved best model (BLEU=3.14) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:40:49] [Epoch 2] train loss = 5.0287
[2025-12-23 01:40:51] [Epoch 2] valid BLEU-4 = 4.44
[2025-12-23 01:40:52] [Checkpoint] Saved best model (BLEU=4.44) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:41:32] [Epoch 3] train loss = 4.6659
[2025-12-23 01:41:34] [Epoch 3] valid BLEU-4 = 5.49
[2025-12-23 01:41:34] [Checkpoint] Saved best model (BLEU=5.49) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:42:14] [Epoch 4] train loss = 4.4073
[2025-12-23 01:42:16] [Epoch 4] valid BLEU-4 = 6.14
[2025-12-23 01:42:16] [Checkpoint] Saved best model (BLEU=6.14) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:42:56] [Epoch 5] train loss = 4.2093
[2025-12-23 01:42:58] [Epoch 5] valid BLEU-4 = 6.99
[2025-12-23 01:42:58] [Checkpoint] Saved best model (BLEU=6.99) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:43:38] [Epoch 6] train loss = 4.0509
[2025-12-23 01:43:40] [Epoch 6] valid BLEU-4 = 7.34
[2025-12-23 01:43:40] [Checkpoint] Saved best model (BLEU=7.34) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:44:20] [Epoch 7] train loss = 3.9195
[2025-12-23 01:44:22] [Epoch 7] valid BLEU-4 = 7.45
[2025-12-23 01:44:22] [Checkpoint] Saved best model (BLEU=7.45) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:45:02] [Epoch 8] train loss = 3.8107
[2025-12-23 01:45:03] [Epoch 8] valid BLEU-4 = 7.95
[2025-12-23 01:45:04] [Checkpoint] Saved best model (BLEU=7.95) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:45:43] [Epoch 9] train loss = 3.7179
[2025-12-23 01:45:45] [Epoch 9] valid BLEU-4 = 8.43
[2025-12-23 01:45:45] [Checkpoint] Saved best model (BLEU=8.43) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:46:25] [Epoch 10] train loss = 3.6357
[2025-12-23 01:46:27] [Epoch 10] valid BLEU-4 = 9.11
[2025-12-23 01:46:27] [Checkpoint] Saved best model (BLEU=9.11) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:47:07] [Epoch 11] train loss = 3.5638
[2025-12-23 01:47:08] [Epoch 11] valid BLEU-4 = 9.63
[2025-12-23 01:47:09] [Checkpoint] Saved best model (BLEU=9.63) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:47:49] [Epoch 12] train loss = 3.5014
[2025-12-23 01:47:51] [Epoch 12] valid BLEU-4 = 9.84
[2025-12-23 01:47:51] [Checkpoint] Saved best model (BLEU=9.84) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:48:31] [Epoch 13] train loss = 3.4446
[2025-12-23 01:48:33] [Epoch 13] valid BLEU-4 = 9.73
[2025-12-23 01:49:13] [Epoch 14] train loss = 3.3925
[2025-12-23 01:49:15] [Epoch 14] valid BLEU-4 = 10.33
[2025-12-23 01:49:15] [Checkpoint] Saved best model (BLEU=10.33) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:49:55] [Epoch 15] train loss = 3.3453
[2025-12-23 01:49:57] [Epoch 15] valid BLEU-4 = 10.04
[2025-12-23 01:50:37] [Epoch 16] train loss = 3.3023
[2025-12-23 01:50:39] [Epoch 16] valid BLEU-4 = 10.79
[2025-12-23 01:50:39] [Checkpoint] Saved best model (BLEU=10.79) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:51:19] [Epoch 17] train loss = 3.2626
[2025-12-23 01:51:21] [Epoch 17] valid BLEU-4 = 10.72
[2025-12-23 01:52:00] [Epoch 18] train loss = 3.2245
[2025-12-23 01:52:02] [Epoch 18] valid BLEU-4 = 10.59
[2025-12-23 01:52:42] [Epoch 19] train loss = 3.1899
[2025-12-23 01:52:44] [Epoch 19] valid BLEU-4 = 10.64
[2025-12-23 01:53:24] [Epoch 20] train loss = 3.1575
[2025-12-23 01:53:25] [Epoch 20] valid BLEU-4 = 10.60
[2025-12-23 01:54:05] [Epoch 21] train loss = 3.1269
[2025-12-23 01:54:06] [Epoch 21] valid BLEU-4 = 10.37
[2025-12-23 01:54:46] [Epoch 22] train loss = 3.0977
[2025-12-23 01:54:48] [Epoch 22] valid BLEU-4 = 10.95
[2025-12-23 01:54:48] [Checkpoint] Saved best model (BLEU=10.95) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:55:28] [Epoch 23] train loss = 3.0709
[2025-12-23 01:55:30] [Epoch 23] valid BLEU-4 = 11.03
[2025-12-23 01:55:30] [Checkpoint] Saved best model (BLEU=11.03) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:56:10] [Epoch 24] train loss = 3.0444
[2025-12-23 01:56:12] [Epoch 24] valid BLEU-4 = 11.10
[2025-12-23 01:56:12] [Checkpoint] Saved best model (BLEU=11.10) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:56:52] [Epoch 25] train loss = 3.0202
[2025-12-23 01:56:54] [Epoch 25] valid BLEU-4 = 10.32
[2025-12-23 01:57:34] [Epoch 26] train loss = 2.9969
[2025-12-23 01:57:35] [Epoch 26] valid BLEU-4 = 11.24
[2025-12-23 01:57:36] [Checkpoint] Saved best model (BLEU=11.24) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 01:58:16] [Epoch 27] train loss = 2.9746
[2025-12-23 01:58:17] [Epoch 27] valid BLEU-4 = 10.97
[2025-12-23 01:58:58] [Epoch 28] train loss = 2.9532
[2025-12-23 01:58:59] [Epoch 28] valid BLEU-4 = 11.04
[2025-12-23 01:59:39] [Epoch 29] train loss = 2.9327
[2025-12-23 01:59:41] [Epoch 29] valid BLEU-4 = 10.80
[2025-12-23 02:00:22] [Epoch 30] train loss = 2.9134
[2025-12-23 02:00:23] [Epoch 30] valid BLEU-4 = 11.01
[2025-12-23 02:01:03] [Epoch 31] train loss = 2.8942
[2025-12-23 02:01:05] [Epoch 31] valid BLEU-4 = 11.02
[2025-12-23 02:01:45] [Epoch 32] train loss = 2.8753
[2025-12-23 02:01:46] [Epoch 32] valid BLEU-4 = 10.48
[2025-12-23 02:02:26] [Epoch 33] train loss = 2.8579
[2025-12-23 02:02:28] [Epoch 33] valid BLEU-4 = 11.32
[2025-12-23 02:02:28] [Checkpoint] Saved best model (BLEU=11.32) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 02:03:08] [Epoch 34] train loss = 2.8419
[2025-12-23 02:03:10] [Epoch 34] valid BLEU-4 = 10.98
[2025-12-23 02:03:49] [Epoch 35] train loss = 2.8246
[2025-12-23 02:03:51] [Epoch 35] valid BLEU-4 = 11.45
[2025-12-23 02:03:51] [Checkpoint] Saved best model (BLEU=11.45) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 02:04:32] [Epoch 36] train loss = 2.8093
[2025-12-23 02:04:34] [Epoch 36] valid BLEU-4 = 11.12
[2025-12-23 02:05:14] [Epoch 37] train loss = 2.7927
[2025-12-23 02:05:16] [Epoch 37] valid BLEU-4 = 11.24
[2025-12-23 02:05:56] [Epoch 38] train loss = 2.7795
[2025-12-23 02:05:57] [Epoch 38] valid BLEU-4 = 10.71
[2025-12-23 02:06:37] [Epoch 39] train loss = 2.7648
[2025-12-23 02:06:39] [Epoch 39] valid BLEU-4 = 11.39
[2025-12-23 02:07:19] [Epoch 40] train loss = 2.7508
[2025-12-23 02:07:21] [Epoch 40] valid BLEU-4 = 10.55
[2025-12-23 02:08:01] [Epoch 41] train loss = 2.7372
[2025-12-23 02:08:03] [Epoch 41] valid BLEU-4 = 10.76
[2025-12-23 02:08:43] [Epoch 42] train loss = 2.7247
[2025-12-23 02:08:44] [Epoch 42] valid BLEU-4 = 11.18
[2025-12-23 02:09:24] [Epoch 43] train loss = 2.7114
[2025-12-23 02:09:26] [Epoch 43] valid BLEU-4 = 11.79
[2025-12-23 02:09:27] [Checkpoint] Saved best model (BLEU=11.79) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model512.pt
[2025-12-23 02:10:06] [Epoch 44] train loss = 2.6995
[2025-12-23 02:10:08] [Epoch 44] valid BLEU-4 = 10.82
[2025-12-23 02:10:48] [Epoch 45] train loss = 2.6873
[2025-12-23 02:10:49] [Epoch 45] valid BLEU-4 = 10.95
[2025-12-23 02:11:29] [Epoch 46] train loss = 2.6765
[2025-12-23 02:11:31] [Epoch 46] valid BLEU-4 = 11.04
[2025-12-23 02:12:11] [Epoch 47] train loss = 2.6652
[2025-12-23 02:12:12] [Epoch 47] valid BLEU-4 = 10.44
[2025-12-23 02:12:52] [Epoch 48] train loss = 2.6535
[2025-12-23 02:12:54] [Epoch 48] valid BLEU-4 = 10.68
[2025-12-23 02:13:34] [Epoch 49] train loss = 2.6444
[2025-12-23 02:13:35] [Epoch 49] valid BLEU-4 = 10.98
[2025-12-23 02:14:15] [Epoch 50] train loss = 2.6318
[2025-12-23 02:14:17] [Epoch 50] valid BLEU-4 = 10.86
[2025-12-23 02:14:17] Loading best checkpoint for test ...
