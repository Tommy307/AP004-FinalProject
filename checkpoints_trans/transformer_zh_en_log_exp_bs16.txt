[2025-12-23 01:34:41] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:34:41] Loading datasets ...
[2025-12-23 01:35:10] Building Transformer model ...
[2025-12-23 01:37:52] [Epoch 1] train loss = 5.7063
[2025-12-23 01:37:58] [Epoch 1] valid BLEU-4 = 3.07
[2025-12-23 01:37:58] [Checkpoint] Saved best model (BLEU=3.07) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:40:35] [Epoch 2] train loss = 5.0370
[2025-12-23 01:40:40] [Epoch 2] valid BLEU-4 = 4.65
[2025-12-23 01:40:41] [Checkpoint] Saved best model (BLEU=4.65) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:43:18] [Epoch 3] train loss = 4.6877
[2025-12-23 01:43:23] [Epoch 3] valid BLEU-4 = 5.21
[2025-12-23 01:43:24] [Checkpoint] Saved best model (BLEU=5.21) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:46:00] [Epoch 4] train loss = 4.4389
[2025-12-23 01:46:05] [Epoch 4] valid BLEU-4 = 5.61
[2025-12-23 01:46:05] [Checkpoint] Saved best model (BLEU=5.61) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:48:42] [Epoch 5] train loss = 4.2548
[2025-12-23 01:48:47] [Epoch 5] valid BLEU-4 = 6.66
[2025-12-23 01:48:48] [Checkpoint] Saved best model (BLEU=6.66) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:51:25] [Epoch 6] train loss = 4.1127
[2025-12-23 01:51:29] [Epoch 6] valid BLEU-4 = 6.81
[2025-12-23 01:51:30] [Checkpoint] Saved best model (BLEU=6.81) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:54:07] [Epoch 7] train loss = 4.0003
[2025-12-23 01:54:12] [Epoch 7] valid BLEU-4 = 8.00
[2025-12-23 01:54:13] [Checkpoint] Saved best model (BLEU=8.00) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 01:56:51] [Epoch 8] train loss = 3.9083
[2025-12-23 01:56:56] [Epoch 8] valid BLEU-4 = 7.83
[2025-12-23 01:59:35] [Epoch 9] train loss = 3.8305
[2025-12-23 01:59:40] [Epoch 9] valid BLEU-4 = 8.17
[2025-12-23 01:59:40] [Checkpoint] Saved best model (BLEU=8.17) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:02:19] [Epoch 10] train loss = 3.7649
[2025-12-23 02:02:24] [Epoch 10] valid BLEU-4 = 9.26
[2025-12-23 02:02:24] [Checkpoint] Saved best model (BLEU=9.26) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:05:02] [Epoch 11] train loss = 3.7081
[2025-12-23 02:05:07] [Epoch 11] valid BLEU-4 = 8.93
[2025-12-23 02:07:44] [Epoch 12] train loss = 3.6574
[2025-12-23 02:07:49] [Epoch 12] valid BLEU-4 = 8.99
[2025-12-23 02:10:28] [Epoch 13] train loss = 3.6124
[2025-12-23 02:10:32] [Epoch 13] valid BLEU-4 = 9.49
[2025-12-23 02:10:33] [Checkpoint] Saved best model (BLEU=9.49) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:13:10] [Epoch 14] train loss = 3.5712
[2025-12-23 02:13:15] [Epoch 14] valid BLEU-4 = 9.93
[2025-12-23 02:13:15] [Checkpoint] Saved best model (BLEU=9.93) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:15:53] [Epoch 15] train loss = 3.5347
[2025-12-23 02:15:57] [Epoch 15] valid BLEU-4 = 9.94
[2025-12-23 02:15:58] [Checkpoint] Saved best model (BLEU=9.94) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:18:35] [Epoch 16] train loss = 3.5018
[2025-12-23 02:18:40] [Epoch 16] valid BLEU-4 = 10.29
[2025-12-23 02:18:41] [Checkpoint] Saved best model (BLEU=10.29) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:21:19] [Epoch 17] train loss = 3.4712
[2025-12-23 02:21:24] [Epoch 17] valid BLEU-4 = 10.22
[2025-12-23 02:24:01] [Epoch 18] train loss = 3.4426
[2025-12-23 02:24:06] [Epoch 18] valid BLEU-4 = 10.31
[2025-12-23 02:24:06] [Checkpoint] Saved best model (BLEU=10.31) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:26:44] [Epoch 19] train loss = 3.4172
[2025-12-23 02:26:49] [Epoch 19] valid BLEU-4 = 10.36
[2025-12-23 02:26:49] [Checkpoint] Saved best model (BLEU=10.36) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:29:27] [Epoch 20] train loss = 3.3948
[2025-12-23 02:29:32] [Epoch 20] valid BLEU-4 = 10.23
[2025-12-23 02:32:10] [Epoch 21] train loss = 3.3732
[2025-12-23 02:32:15] [Epoch 21] valid BLEU-4 = 10.91
[2025-12-23 02:32:15] [Checkpoint] Saved best model (BLEU=10.91) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:34:52] [Epoch 22] train loss = 3.3522
[2025-12-23 02:34:57] [Epoch 22] valid BLEU-4 = 10.30
[2025-12-23 02:37:35] [Epoch 23] train loss = 3.3333
[2025-12-23 02:37:40] [Epoch 23] valid BLEU-4 = 11.00
[2025-12-23 02:37:41] [Checkpoint] Saved best model (BLEU=11.00) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:40:19] [Epoch 24] train loss = 3.3158
[2025-12-23 02:40:24] [Epoch 24] valid BLEU-4 = 11.55
[2025-12-23 02:40:24] [Checkpoint] Saved best model (BLEU=11.55) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:43:01] [Epoch 25] train loss = 3.2979
[2025-12-23 02:43:06] [Epoch 25] valid BLEU-4 = 11.32
[2025-12-23 02:45:44] [Epoch 26] train loss = 3.2826
[2025-12-23 02:45:49] [Epoch 26] valid BLEU-4 = 11.21
[2025-12-23 02:48:27] [Epoch 27] train loss = 3.2669
[2025-12-23 02:48:32] [Epoch 27] valid BLEU-4 = 11.24
[2025-12-23 02:51:10] [Epoch 28] train loss = 3.2528
[2025-12-23 02:51:15] [Epoch 28] valid BLEU-4 = 11.03
[2025-12-23 02:53:53] [Epoch 29] train loss = 3.2407
[2025-12-23 02:53:59] [Epoch 29] valid BLEU-4 = 11.42
[2025-12-23 02:56:36] [Epoch 30] train loss = 3.2271
[2025-12-23 02:56:41] [Epoch 30] valid BLEU-4 = 11.55
[2025-12-23 02:56:41] [Checkpoint] Saved best model (BLEU=11.55) to ./checkpoints_trans/transformer_zh_en_best_exp_bs16.pt
[2025-12-23 02:59:18] [Epoch 31] train loss = 3.2149
[2025-12-23 02:59:23] [Epoch 31] valid BLEU-4 = 11.18
[2025-12-23 03:02:00] [Epoch 32] train loss = 3.2031
[2025-12-23 03:02:05] [Epoch 32] valid BLEU-4 = 10.87
