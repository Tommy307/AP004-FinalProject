[2025-12-23 01:36:57] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:36:57] Loading datasets ...
[2025-12-23 01:37:24] Building Transformer model ...
[2025-12-23 01:38:08] [Epoch 1] train loss = 5.4703
[2025-12-23 01:38:10] [Epoch 1] valid BLEU-4 = 4.23
[2025-12-23 01:38:10] [Checkpoint] Saved best model (BLEU=4.23) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:38:49] [Epoch 2] train loss = 4.6250
[2025-12-23 01:38:51] [Epoch 2] valid BLEU-4 = 5.92
[2025-12-23 01:38:51] [Checkpoint] Saved best model (BLEU=5.92) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:39:31] [Epoch 3] train loss = 4.2505
[2025-12-23 01:39:32] [Epoch 3] valid BLEU-4 = 6.93
[2025-12-23 01:39:33] [Checkpoint] Saved best model (BLEU=6.93) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:40:12] [Epoch 4] train loss = 4.0319
[2025-12-23 01:40:14] [Epoch 4] valid BLEU-4 = 8.41
[2025-12-23 01:40:15] [Checkpoint] Saved best model (BLEU=8.41) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:40:56] [Epoch 5] train loss = 3.8869
[2025-12-23 01:40:57] [Epoch 5] valid BLEU-4 = 8.58
[2025-12-23 01:40:57] [Checkpoint] Saved best model (BLEU=8.58) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:41:37] [Epoch 6] train loss = 3.7826
[2025-12-23 01:41:38] [Epoch 6] valid BLEU-4 = 9.96
[2025-12-23 01:41:38] [Checkpoint] Saved best model (BLEU=9.96) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:42:17] [Epoch 7] train loss = 3.7022
[2025-12-23 01:42:19] [Epoch 7] valid BLEU-4 = 10.03
[2025-12-23 01:42:19] [Checkpoint] Saved best model (BLEU=10.03) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:42:58] [Epoch 8] train loss = 3.6387
[2025-12-23 01:43:00] [Epoch 8] valid BLEU-4 = 10.01
[2025-12-23 01:43:39] [Epoch 9] train loss = 3.5875
[2025-12-23 01:43:41] [Epoch 9] valid BLEU-4 = 10.61
[2025-12-23 01:43:41] [Checkpoint] Saved best model (BLEU=10.61) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:44:20] [Epoch 10] train loss = 3.5441
[2025-12-23 01:44:21] [Epoch 10] valid BLEU-4 = 10.74
[2025-12-23 01:44:22] [Checkpoint] Saved best model (BLEU=10.74) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:45:01] [Epoch 11] train loss = 3.5044
[2025-12-23 01:45:03] [Epoch 11] valid BLEU-4 = 10.01
[2025-12-23 01:45:42] [Epoch 12] train loss = 3.4724
[2025-12-23 01:45:43] [Epoch 12] valid BLEU-4 = 10.66
[2025-12-23 01:46:22] [Epoch 13] train loss = 3.4430
[2025-12-23 01:46:23] [Epoch 13] valid BLEU-4 = 11.16
[2025-12-23 01:46:24] [Checkpoint] Saved best model (BLEU=11.16) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:47:02] [Epoch 14] train loss = 3.4174
[2025-12-23 01:47:04] [Epoch 14] valid BLEU-4 = 11.03
[2025-12-23 01:47:43] [Epoch 15] train loss = 3.3922
[2025-12-23 01:47:45] [Epoch 15] valid BLEU-4 = 10.90
[2025-12-23 01:48:23] [Epoch 16] train loss = 3.3700
[2025-12-23 01:48:25] [Epoch 16] valid BLEU-4 = 10.71
[2025-12-23 01:49:03] [Epoch 17] train loss = 3.3512
[2025-12-23 01:49:05] [Epoch 17] valid BLEU-4 = 11.23
[2025-12-23 01:49:05] [Checkpoint] Saved best model (BLEU=11.23) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:49:44] [Epoch 18] train loss = 3.3326
[2025-12-23 01:49:46] [Epoch 18] valid BLEU-4 = 11.57
[2025-12-23 01:49:46] [Checkpoint] Saved best model (BLEU=11.57) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:50:25] [Epoch 19] train loss = 3.3145
[2025-12-23 01:50:26] [Epoch 19] valid BLEU-4 = 10.90
[2025-12-23 01:51:05] [Epoch 20] train loss = 3.2981
[2025-12-23 01:51:07] [Epoch 20] valid BLEU-4 = 11.81
[2025-12-23 01:51:07] [Checkpoint] Saved best model (BLEU=11.81) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:51:46] [Epoch 21] train loss = 3.2841
[2025-12-23 01:51:47] [Epoch 21] valid BLEU-4 = 10.45
[2025-12-23 01:52:27] [Epoch 22] train loss = 3.2694
[2025-12-23 01:52:28] [Epoch 22] valid BLEU-4 = 11.35
[2025-12-23 01:53:07] [Epoch 23] train loss = 3.2572
[2025-12-23 01:53:08] [Epoch 23] valid BLEU-4 = 11.89
[2025-12-23 01:53:08] [Checkpoint] Saved best model (BLEU=11.89) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:53:47] [Epoch 24] train loss = 3.2448
[2025-12-23 01:53:49] [Epoch 24] valid BLEU-4 = 11.85
[2025-12-23 01:54:28] [Epoch 25] train loss = 3.2340
[2025-12-23 01:54:29] [Epoch 25] valid BLEU-4 = 11.58
[2025-12-23 01:55:08] [Epoch 26] train loss = 3.2215
[2025-12-23 01:55:10] [Epoch 26] valid BLEU-4 = 11.25
[2025-12-23 01:55:49] [Epoch 27] train loss = 3.2118
[2025-12-23 01:55:50] [Epoch 27] valid BLEU-4 = 11.82
[2025-12-23 01:56:30] [Epoch 28] train loss = 3.2006
[2025-12-23 01:56:31] [Epoch 28] valid BLEU-4 = 11.73
[2025-12-23 01:57:12] [Epoch 29] train loss = 3.1921
[2025-12-23 01:57:13] [Epoch 29] valid BLEU-4 = 11.47
[2025-12-23 01:57:52] [Epoch 30] train loss = 3.1825
[2025-12-23 01:57:54] [Epoch 30] valid BLEU-4 = 11.83
[2025-12-23 01:58:32] [Epoch 31] train loss = 3.1728
[2025-12-23 01:58:34] [Epoch 31] valid BLEU-4 = 11.82
[2025-12-23 01:59:13] [Epoch 32] train loss = 3.1632
[2025-12-23 01:59:14] [Epoch 32] valid BLEU-4 = 11.91
[2025-12-23 01:59:14] [Checkpoint] Saved best model (BLEU=11.91) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 01:59:54] [Epoch 33] train loss = 3.1549
[2025-12-23 01:59:55] [Epoch 33] valid BLEU-4 = 11.86
[2025-12-23 02:00:35] [Epoch 34] train loss = 3.1484
[2025-12-23 02:00:36] [Epoch 34] valid BLEU-4 = 11.99
[2025-12-23 02:00:36] [Checkpoint] Saved best model (BLEU=11.99) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 02:01:15] [Epoch 35] train loss = 3.1409
[2025-12-23 02:01:17] [Epoch 35] valid BLEU-4 = 12.45
[2025-12-23 02:01:17] [Checkpoint] Saved best model (BLEU=12.45) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 02:01:56] [Epoch 36] train loss = 3.1336
[2025-12-23 02:01:57] [Epoch 36] valid BLEU-4 = 11.98
[2025-12-23 02:02:36] [Epoch 37] train loss = 3.1254
[2025-12-23 02:02:38] [Epoch 37] valid BLEU-4 = 12.57
[2025-12-23 02:02:38] [Checkpoint] Saved best model (BLEU=12.57) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-4.pt
[2025-12-23 02:03:16] [Epoch 38] train loss = 3.1182
[2025-12-23 02:03:18] [Epoch 38] valid BLEU-4 = 11.83
[2025-12-23 02:03:57] [Epoch 39] train loss = 3.1125
[2025-12-23 02:03:58] [Epoch 39] valid BLEU-4 = 11.67
[2025-12-23 02:04:37] [Epoch 40] train loss = 3.1055
[2025-12-23 02:04:39] [Epoch 40] valid BLEU-4 = 12.10
[2025-12-23 02:05:18] [Epoch 41] train loss = 3.0981
[2025-12-23 02:05:19] [Epoch 41] valid BLEU-4 = 12.44
[2025-12-23 02:05:58] [Epoch 42] train loss = 3.0931
[2025-12-23 02:06:00] [Epoch 42] valid BLEU-4 = 11.83
[2025-12-23 02:06:39] [Epoch 43] train loss = 3.0866
[2025-12-23 02:06:40] [Epoch 43] valid BLEU-4 = 12.51
[2025-12-23 02:07:19] [Epoch 44] train loss = 3.0809
[2025-12-23 02:07:21] [Epoch 44] valid BLEU-4 = 12.09
[2025-12-23 02:08:00] [Epoch 45] train loss = 3.0743
[2025-12-23 02:08:02] [Epoch 45] valid BLEU-4 = 11.94
[2025-12-23 02:08:41] [Epoch 46] train loss = 3.0702
[2025-12-23 02:08:43] [Epoch 46] valid BLEU-4 = 12.35
[2025-12-23 02:09:22] [Epoch 47] train loss = 3.0646
[2025-12-23 02:09:24] [Epoch 47] valid BLEU-4 = 11.85
[2025-12-23 02:10:03] [Epoch 48] train loss = 3.0595
[2025-12-23 02:10:04] [Epoch 48] valid BLEU-4 = 12.07
[2025-12-23 02:10:43] [Epoch 49] train loss = 3.0537
[2025-12-23 02:10:45] [Epoch 49] valid BLEU-4 = 11.87
[2025-12-23 02:11:24] [Epoch 50] train loss = 3.0477
[2025-12-23 02:11:25] [Epoch 50] valid BLEU-4 = 12.23
[2025-12-23 02:11:25] Loading best checkpoint for test ...
