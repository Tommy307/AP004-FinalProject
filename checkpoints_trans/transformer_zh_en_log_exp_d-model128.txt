[2025-12-23 01:38:42] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:38:42] Loading datasets ...
[2025-12-23 01:39:09] Building Transformer model ...
[2025-12-23 01:39:52] [Epoch 1] train loss = 6.3002
[2025-12-23 01:39:54] [Epoch 1] valid BLEU-4 = 2.17
[2025-12-23 01:39:54] [Checkpoint] Saved best model (BLEU=2.17) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:40:33] [Epoch 2] train loss = 5.7366
[2025-12-23 01:40:34] [Epoch 2] valid BLEU-4 = 2.29
[2025-12-23 01:40:35] [Checkpoint] Saved best model (BLEU=2.29) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:41:13] [Epoch 3] train loss = 5.4927
[2025-12-23 01:41:15] [Epoch 3] valid BLEU-4 = 2.88
[2025-12-23 01:41:15] [Checkpoint] Saved best model (BLEU=2.88) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:41:54] [Epoch 4] train loss = 5.3117
[2025-12-23 01:41:56] [Epoch 4] valid BLEU-4 = 2.98
[2025-12-23 01:41:56] [Checkpoint] Saved best model (BLEU=2.98) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:42:34] [Epoch 5] train loss = 5.1671
[2025-12-23 01:42:36] [Epoch 5] valid BLEU-4 = 3.51
[2025-12-23 01:42:36] [Checkpoint] Saved best model (BLEU=3.51) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:43:15] [Epoch 6] train loss = 5.0493
[2025-12-23 01:43:16] [Epoch 6] valid BLEU-4 = 3.50
[2025-12-23 01:43:55] [Epoch 7] train loss = 4.9473
[2025-12-23 01:43:56] [Epoch 7] valid BLEU-4 = 4.12
[2025-12-23 01:43:56] [Checkpoint] Saved best model (BLEU=4.12) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:44:35] [Epoch 8] train loss = 4.8579
[2025-12-23 01:44:36] [Epoch 8] valid BLEU-4 = 4.43
[2025-12-23 01:44:36] [Checkpoint] Saved best model (BLEU=4.43) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:45:15] [Epoch 9] train loss = 4.7770
[2025-12-23 01:45:16] [Epoch 9] valid BLEU-4 = 4.77
[2025-12-23 01:45:16] [Checkpoint] Saved best model (BLEU=4.77) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:45:54] [Epoch 10] train loss = 4.7032
[2025-12-23 01:45:56] [Epoch 10] valid BLEU-4 = 4.59
[2025-12-23 01:46:34] [Epoch 11] train loss = 4.6360
[2025-12-23 01:46:36] [Epoch 11] valid BLEU-4 = 5.21
[2025-12-23 01:46:36] [Checkpoint] Saved best model (BLEU=5.21) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:47:14] [Epoch 12] train loss = 4.5739
[2025-12-23 01:47:16] [Epoch 12] valid BLEU-4 = 5.12
[2025-12-23 01:47:54] [Epoch 13] train loss = 4.5177
[2025-12-23 01:47:55] [Epoch 13] valid BLEU-4 = 5.72
[2025-12-23 01:47:56] [Checkpoint] Saved best model (BLEU=5.72) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:48:34] [Epoch 14] train loss = 4.4661
[2025-12-23 01:48:36] [Epoch 14] valid BLEU-4 = 5.44
[2025-12-23 01:49:14] [Epoch 15] train loss = 4.4197
[2025-12-23 01:49:15] [Epoch 15] valid BLEU-4 = 5.71
[2025-12-23 01:49:54] [Epoch 16] train loss = 4.3738
[2025-12-23 01:49:55] [Epoch 16] valid BLEU-4 = 6.01
[2025-12-23 01:49:56] [Checkpoint] Saved best model (BLEU=6.01) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:50:34] [Epoch 17] train loss = 4.3337
[2025-12-23 01:50:35] [Epoch 17] valid BLEU-4 = 6.37
[2025-12-23 01:50:35] [Checkpoint] Saved best model (BLEU=6.37) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:51:14] [Epoch 18] train loss = 4.2967
[2025-12-23 01:51:15] [Epoch 18] valid BLEU-4 = 6.03
[2025-12-23 01:51:53] [Epoch 19] train loss = 4.2627
[2025-12-23 01:51:55] [Epoch 19] valid BLEU-4 = 6.73
[2025-12-23 01:51:55] [Checkpoint] Saved best model (BLEU=6.73) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:52:33] [Epoch 20] train loss = 4.2292
[2025-12-23 01:52:35] [Epoch 20] valid BLEU-4 = 6.78
[2025-12-23 01:52:35] [Checkpoint] Saved best model (BLEU=6.78) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:53:13] [Epoch 21] train loss = 4.1992
[2025-12-23 01:53:15] [Epoch 21] valid BLEU-4 = 7.07
[2025-12-23 01:53:15] [Checkpoint] Saved best model (BLEU=7.07) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:53:53] [Epoch 22] train loss = 4.1698
[2025-12-23 01:53:54] [Epoch 22] valid BLEU-4 = 6.91
[2025-12-23 01:54:32] [Epoch 23] train loss = 4.1430
[2025-12-23 01:54:34] [Epoch 23] valid BLEU-4 = 7.05
[2025-12-23 01:55:12] [Epoch 24] train loss = 4.1168
[2025-12-23 01:55:14] [Epoch 24] valid BLEU-4 = 7.30
[2025-12-23 01:55:14] [Checkpoint] Saved best model (BLEU=7.30) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:55:52] [Epoch 25] train loss = 4.0931
[2025-12-23 01:55:54] [Epoch 25] valid BLEU-4 = 7.48
[2025-12-23 01:55:54] [Checkpoint] Saved best model (BLEU=7.48) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:56:32] [Epoch 26] train loss = 4.0711
[2025-12-23 01:56:34] [Epoch 26] valid BLEU-4 = 7.07
[2025-12-23 01:57:12] [Epoch 27] train loss = 4.0496
[2025-12-23 01:57:14] [Epoch 27] valid BLEU-4 = 7.53
[2025-12-23 01:57:14] [Checkpoint] Saved best model (BLEU=7.53) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:57:53] [Epoch 28] train loss = 4.0298
[2025-12-23 01:57:54] [Epoch 28] valid BLEU-4 = 7.82
[2025-12-23 01:57:54] [Checkpoint] Saved best model (BLEU=7.82) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:58:33] [Epoch 29] train loss = 4.0104
[2025-12-23 01:58:34] [Epoch 29] valid BLEU-4 = 8.13
[2025-12-23 01:58:35] [Checkpoint] Saved best model (BLEU=8.13) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 01:59:13] [Epoch 30] train loss = 3.9919
[2025-12-23 01:59:15] [Epoch 30] valid BLEU-4 = 7.55
[2025-12-23 01:59:53] [Epoch 31] train loss = 3.9743
[2025-12-23 01:59:54] [Epoch 31] valid BLEU-4 = 7.91
[2025-12-23 02:00:34] [Epoch 32] train loss = 3.9571
[2025-12-23 02:00:35] [Epoch 32] valid BLEU-4 = 8.22
[2025-12-23 02:00:35] [Checkpoint] Saved best model (BLEU=8.22) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:01:14] [Epoch 33] train loss = 3.9413
[2025-12-23 02:01:15] [Epoch 33] valid BLEU-4 = 8.22
[2025-12-23 02:01:54] [Epoch 34] train loss = 3.9256
[2025-12-23 02:01:55] [Epoch 34] valid BLEU-4 = 8.25
[2025-12-23 02:01:55] [Checkpoint] Saved best model (BLEU=8.25) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:02:34] [Epoch 35] train loss = 3.9109
[2025-12-23 02:02:35] [Epoch 35] valid BLEU-4 = 8.35
[2025-12-23 02:02:36] [Checkpoint] Saved best model (BLEU=8.35) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:03:14] [Epoch 36] train loss = 3.8975
[2025-12-23 02:03:15] [Epoch 36] valid BLEU-4 = 8.45
[2025-12-23 02:03:15] [Checkpoint] Saved best model (BLEU=8.45) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:03:54] [Epoch 37] train loss = 3.8837
[2025-12-23 02:03:55] [Epoch 37] valid BLEU-4 = 8.60
[2025-12-23 02:03:56] [Checkpoint] Saved best model (BLEU=8.60) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:04:34] [Epoch 38] train loss = 3.8705
[2025-12-23 02:04:36] [Epoch 38] valid BLEU-4 = 8.84
[2025-12-23 02:04:36] [Checkpoint] Saved best model (BLEU=8.84) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:05:14] [Epoch 39] train loss = 3.8581
[2025-12-23 02:05:16] [Epoch 39] valid BLEU-4 = 8.55
[2025-12-23 02:05:54] [Epoch 40] train loss = 3.8458
[2025-12-23 02:05:55] [Epoch 40] valid BLEU-4 = 8.99
[2025-12-23 02:05:55] [Checkpoint] Saved best model (BLEU=8.99) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:06:33] [Epoch 41] train loss = 3.8344
[2025-12-23 02:06:35] [Epoch 41] valid BLEU-4 = 8.95
[2025-12-23 02:07:13] [Epoch 42] train loss = 3.8225
[2025-12-23 02:07:14] [Epoch 42] valid BLEU-4 = 9.03
[2025-12-23 02:07:15] [Checkpoint] Saved best model (BLEU=9.03) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:07:53] [Epoch 43] train loss = 3.8110
[2025-12-23 02:07:55] [Epoch 43] valid BLEU-4 = 9.20
[2025-12-23 02:07:55] [Checkpoint] Saved best model (BLEU=9.20) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:08:33] [Epoch 44] train loss = 3.8002
[2025-12-23 02:08:34] [Epoch 44] valid BLEU-4 = 9.54
[2025-12-23 02:08:35] [Checkpoint] Saved best model (BLEU=9.54) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:09:13] [Epoch 45] train loss = 3.7901
[2025-12-23 02:09:14] [Epoch 45] valid BLEU-4 = 9.34
[2025-12-23 02:09:52] [Epoch 46] train loss = 3.7795
[2025-12-23 02:09:54] [Epoch 46] valid BLEU-4 = 9.04
[2025-12-23 02:10:32] [Epoch 47] train loss = 3.7699
[2025-12-23 02:10:34] [Epoch 47] valid BLEU-4 = 9.45
[2025-12-23 02:11:12] [Epoch 48] train loss = 3.7607
[2025-12-23 02:11:13] [Epoch 48] valid BLEU-4 = 9.49
[2025-12-23 02:11:52] [Epoch 49] train loss = 3.7513
[2025-12-23 02:11:53] [Epoch 49] valid BLEU-4 = 9.32
[2025-12-23 02:12:31] [Epoch 50] train loss = 3.7421
[2025-12-23 02:12:33] [Epoch 50] valid BLEU-4 = 9.96
[2025-12-23 02:12:33] [Checkpoint] Saved best model (BLEU=9.96) to ./checkpoints_trans/transformer_zh_en_best_exp_d-model128.pt
[2025-12-23 02:12:33] Loading best checkpoint for test ...
