[2025-12-23 01:24:55] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:24:55] Loading datasets ...
[2025-12-23 01:25:22] Building Transformer model ...
[2025-12-23 01:26:16] [Epoch 1] train loss = 5.9884
[2025-12-23 01:26:19] [Epoch 1] valid BLEU-4 = 2.48
[2025-12-23 01:26:19] [Checkpoint] Saved best model (BLEU=2.48) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:27:08] [Epoch 2] train loss = 5.3947
[2025-12-23 01:27:10] [Epoch 2] valid BLEU-4 = 3.35
[2025-12-23 01:27:10] [Checkpoint] Saved best model (BLEU=3.35) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:27:59] [Epoch 3] train loss = 5.1104
[2025-12-23 01:28:02] [Epoch 3] valid BLEU-4 = 3.51
[2025-12-23 01:28:02] [Checkpoint] Saved best model (BLEU=3.51) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:28:51] [Epoch 4] train loss = 4.9021
[2025-12-23 01:28:53] [Epoch 4] valid BLEU-4 = 3.93
[2025-12-23 01:28:53] [Checkpoint] Saved best model (BLEU=3.93) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:29:42] [Epoch 5] train loss = 4.7313
[2025-12-23 01:29:45] [Epoch 5] valid BLEU-4 = 5.03
[2025-12-23 01:29:45] [Checkpoint] Saved best model (BLEU=5.03) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:30:35] [Epoch 6] train loss = 4.5834
[2025-12-23 01:30:37] [Epoch 6] valid BLEU-4 = 5.54
[2025-12-23 01:30:37] [Checkpoint] Saved best model (BLEU=5.54) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:31:26] [Epoch 7] train loss = 4.4555
[2025-12-23 01:31:28] [Epoch 7] valid BLEU-4 = 5.65
[2025-12-23 01:31:29] [Checkpoint] Saved best model (BLEU=5.65) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:32:18] [Epoch 8] train loss = 4.3447
[2025-12-23 01:32:20] [Epoch 8] valid BLEU-4 = 6.49
[2025-12-23 01:32:20] [Checkpoint] Saved best model (BLEU=6.49) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:33:09] [Epoch 9] train loss = 4.2497
[2025-12-23 01:33:12] [Epoch 9] valid BLEU-4 = 7.03
[2025-12-23 01:33:12] [Checkpoint] Saved best model (BLEU=7.03) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:34:01] [Epoch 10] train loss = 4.1644
[2025-12-23 01:34:03] [Epoch 10] valid BLEU-4 = 6.22
[2025-12-23 01:34:53] [Epoch 11] train loss = 4.0887
[2025-12-23 01:34:55] [Epoch 11] valid BLEU-4 = 7.19
[2025-12-23 01:34:55] [Checkpoint] Saved best model (BLEU=7.19) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:35:45] [Epoch 12] train loss = 4.0220
[2025-12-23 01:35:47] [Epoch 12] valid BLEU-4 = 7.61
[2025-12-23 01:35:47] [Checkpoint] Saved best model (BLEU=7.61) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:36:37] [Epoch 13] train loss = 3.9623
[2025-12-23 01:36:39] [Epoch 13] valid BLEU-4 = 8.03
[2025-12-23 01:36:39] [Checkpoint] Saved best model (BLEU=8.03) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:37:29] [Epoch 14] train loss = 3.9095
[2025-12-23 01:37:31] [Epoch 14] valid BLEU-4 = 8.03
[2025-12-23 01:37:31] [Checkpoint] Saved best model (BLEU=8.03) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:38:20] [Epoch 15] train loss = 3.8603
[2025-12-23 01:38:22] [Epoch 15] valid BLEU-4 = 8.02
[2025-12-23 01:39:12] [Epoch 16] train loss = 3.8161
[2025-12-23 01:39:14] [Epoch 16] valid BLEU-4 = 8.28
[2025-12-23 01:39:14] [Checkpoint] Saved best model (BLEU=8.28) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:40:04] [Epoch 17] train loss = 3.7758
[2025-12-23 01:40:06] [Epoch 17] valid BLEU-4 = 8.45
[2025-12-23 01:40:06] [Checkpoint] Saved best model (BLEU=8.45) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:40:56] [Epoch 18] train loss = 3.7381
[2025-12-23 01:40:58] [Epoch 18] valid BLEU-4 = 8.85
[2025-12-23 01:40:58] [Checkpoint] Saved best model (BLEU=8.85) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:41:48] [Epoch 19] train loss = 3.7047
[2025-12-23 01:41:51] [Epoch 19] valid BLEU-4 = 9.33
[2025-12-23 01:41:51] [Checkpoint] Saved best model (BLEU=9.33) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:42:40] [Epoch 20] train loss = 3.6734
[2025-12-23 01:42:43] [Epoch 20] valid BLEU-4 = 9.17
[2025-12-23 01:43:32] [Epoch 21] train loss = 3.6435
[2025-12-23 01:43:34] [Epoch 21] valid BLEU-4 = 9.27
[2025-12-23 01:44:24] [Epoch 22] train loss = 3.6163
[2025-12-23 01:44:26] [Epoch 22] valid BLEU-4 = 9.17
[2025-12-23 01:45:15] [Epoch 23] train loss = 3.5907
[2025-12-23 01:45:17] [Epoch 23] valid BLEU-4 = 9.16
[2025-12-23 01:46:07] [Epoch 24] train loss = 3.5668
[2025-12-23 01:46:09] [Epoch 24] valid BLEU-4 = 8.88
[2025-12-23 01:46:57] [Epoch 25] train loss = 3.5445
[2025-12-23 01:46:59] [Epoch 25] valid BLEU-4 = 9.71
[2025-12-23 01:47:00] [Checkpoint] Saved best model (BLEU=9.71) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:47:50] [Epoch 26] train loss = 3.5226
[2025-12-23 01:47:52] [Epoch 26] valid BLEU-4 = 10.33
[2025-12-23 01:47:52] [Checkpoint] Saved best model (BLEU=10.33) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:48:41] [Epoch 27] train loss = 3.5020
[2025-12-23 01:48:43] [Epoch 27] valid BLEU-4 = 9.90
[2025-12-23 01:49:33] [Epoch 28] train loss = 3.4827
[2025-12-23 01:49:34] [Epoch 28] valid BLEU-4 = 9.67
[2025-12-23 01:50:23] [Epoch 29] train loss = 3.4634
[2025-12-23 01:50:25] [Epoch 29] valid BLEU-4 = 10.19
[2025-12-23 01:51:15] [Epoch 30] train loss = 3.4463
[2025-12-23 01:51:17] [Epoch 30] valid BLEU-4 = 9.77
[2025-12-23 01:52:06] [Epoch 31] train loss = 3.4295
[2025-12-23 01:52:08] [Epoch 31] valid BLEU-4 = 10.28
[2025-12-23 01:52:57] [Epoch 32] train loss = 3.4135
[2025-12-23 01:52:59] [Epoch 32] valid BLEU-4 = 9.83
[2025-12-23 01:53:48] [Epoch 33] train loss = 3.3979
[2025-12-23 01:53:50] [Epoch 33] valid BLEU-4 = 11.13
[2025-12-23 01:53:50] [Checkpoint] Saved best model (BLEU=11.13) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 01:54:40] [Epoch 34] train loss = 3.3841
[2025-12-23 01:54:42] [Epoch 34] valid BLEU-4 = 10.26
[2025-12-23 01:55:31] [Epoch 35] train loss = 3.3695
[2025-12-23 01:55:33] [Epoch 35] valid BLEU-4 = 11.11
[2025-12-23 01:56:22] [Epoch 36] train loss = 3.3567
[2025-12-23 01:56:24] [Epoch 36] valid BLEU-4 = 10.83
[2025-12-23 01:57:13] [Epoch 37] train loss = 3.3432
[2025-12-23 01:57:14] [Epoch 37] valid BLEU-4 = 10.30
[2025-12-23 01:58:03] [Epoch 38] train loss = 3.3311
[2025-12-23 01:58:05] [Epoch 38] valid BLEU-4 = 10.57
[2025-12-23 01:58:54] [Epoch 39] train loss = 3.3189
[2025-12-23 01:58:56] [Epoch 39] valid BLEU-4 = 10.71
[2025-12-23 01:59:45] [Epoch 40] train loss = 3.3070
[2025-12-23 01:59:47] [Epoch 40] valid BLEU-4 = 10.79
[2025-12-23 02:00:37] [Epoch 41] train loss = 3.2960
[2025-12-23 02:00:39] [Epoch 41] valid BLEU-4 = 11.32
[2025-12-23 02:00:39] [Checkpoint] Saved best model (BLEU=11.32) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 02:01:29] [Epoch 42] train loss = 3.2848
[2025-12-23 02:01:31] [Epoch 42] valid BLEU-4 = 9.79
[2025-12-23 02:02:19] [Epoch 43] train loss = 3.2746
[2025-12-23 02:02:21] [Epoch 43] valid BLEU-4 = 11.29
[2025-12-23 02:02:56] [Epoch 44] train loss = 3.2640
[2025-12-23 02:02:58] [Epoch 44] valid BLEU-4 = 11.26
[2025-12-23 02:03:33] [Epoch 45] train loss = 3.2542
[2025-12-23 02:03:34] [Epoch 45] valid BLEU-4 = 11.38
[2025-12-23 02:03:34] [Checkpoint] Saved best model (BLEU=11.38) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 02:04:08] [Epoch 46] train loss = 3.2442
[2025-12-23 02:04:10] [Epoch 46] valid BLEU-4 = 11.42
[2025-12-23 02:04:10] [Checkpoint] Saved best model (BLEU=11.42) to ./checkpoints_trans/transformer_zh_en_best_exp_relaPE.pt
[2025-12-23 02:04:44] [Epoch 47] train loss = 3.2356
[2025-12-23 02:04:46] [Epoch 47] valid BLEU-4 = 11.05
[2025-12-23 02:05:20] [Epoch 48] train loss = 3.2267
[2025-12-23 02:05:21] [Epoch 48] valid BLEU-4 = 11.08
[2025-12-23 02:05:55] [Epoch 49] train loss = 3.2180
[2025-12-23 02:05:57] [Epoch 49] valid BLEU-4 = 10.80
[2025-12-23 02:06:30] [Epoch 50] train loss = 3.2097
[2025-12-23 02:06:32] [Epoch 50] valid BLEU-4 = 11.41
[2025-12-23 02:06:32] Loading best checkpoint for test ...
