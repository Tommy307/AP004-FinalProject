[2025-12-23 01:36:41] === Transformer NMT from scratch (zh->en) ===
[2025-12-23 01:36:41] Loading datasets ...
[2025-12-23 01:37:07] Building Transformer model ...
[2025-12-23 01:37:51] [Epoch 1] train loss = 6.2458
[2025-12-23 01:37:53] [Epoch 1] valid BLEU-4 = 2.38
[2025-12-23 01:37:53] [Checkpoint] Saved best model (BLEU=2.38) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:38:32] [Epoch 2] train loss = 5.6959
[2025-12-23 01:38:34] [Epoch 2] valid BLEU-4 = 2.53
[2025-12-23 01:38:34] [Checkpoint] Saved best model (BLEU=2.53) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:39:14] [Epoch 3] train loss = 5.4582
[2025-12-23 01:39:15] [Epoch 3] valid BLEU-4 = 2.90
[2025-12-23 01:39:15] [Checkpoint] Saved best model (BLEU=2.90) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:39:54] [Epoch 4] train loss = 5.2822
[2025-12-23 01:39:56] [Epoch 4] valid BLEU-4 = 3.15
[2025-12-23 01:39:56] [Checkpoint] Saved best model (BLEU=3.15) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:40:34] [Epoch 5] train loss = 5.1385
[2025-12-23 01:40:36] [Epoch 5] valid BLEU-4 = 3.63
[2025-12-23 01:40:37] [Checkpoint] Saved best model (BLEU=3.63) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:41:15] [Epoch 6] train loss = 5.0175
[2025-12-23 01:41:17] [Epoch 6] valid BLEU-4 = 4.00
[2025-12-23 01:41:17] [Checkpoint] Saved best model (BLEU=4.00) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:41:56] [Epoch 7] train loss = 4.9099
[2025-12-23 01:41:57] [Epoch 7] valid BLEU-4 = 4.22
[2025-12-23 01:41:58] [Checkpoint] Saved best model (BLEU=4.22) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:42:36] [Epoch 8] train loss = 4.8132
[2025-12-23 01:42:38] [Epoch 8] valid BLEU-4 = 4.42
[2025-12-23 01:42:38] [Checkpoint] Saved best model (BLEU=4.42) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:43:17] [Epoch 9] train loss = 4.7252
[2025-12-23 01:43:19] [Epoch 9] valid BLEU-4 = 4.54
[2025-12-23 01:43:19] [Checkpoint] Saved best model (BLEU=4.54) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:43:57] [Epoch 10] train loss = 4.6450
[2025-12-23 01:43:59] [Epoch 10] valid BLEU-4 = 4.83
[2025-12-23 01:43:59] [Checkpoint] Saved best model (BLEU=4.83) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:44:38] [Epoch 11] train loss = 4.5709
[2025-12-23 01:44:39] [Epoch 11] valid BLEU-4 = 5.07
[2025-12-23 01:44:40] [Checkpoint] Saved best model (BLEU=5.07) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:45:18] [Epoch 12] train loss = 4.5026
[2025-12-23 01:45:20] [Epoch 12] valid BLEU-4 = 5.37
[2025-12-23 01:45:20] [Checkpoint] Saved best model (BLEU=5.37) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:45:58] [Epoch 13] train loss = 4.4385
[2025-12-23 01:46:00] [Epoch 13] valid BLEU-4 = 5.50
[2025-12-23 01:46:00] [Checkpoint] Saved best model (BLEU=5.50) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:46:39] [Epoch 14] train loss = 4.3794
[2025-12-23 01:46:40] [Epoch 14] valid BLEU-4 = 5.99
[2025-12-23 01:46:41] [Checkpoint] Saved best model (BLEU=5.99) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:47:19] [Epoch 15] train loss = 4.3250
[2025-12-23 01:47:21] [Epoch 15] valid BLEU-4 = 6.21
[2025-12-23 01:47:21] [Checkpoint] Saved best model (BLEU=6.21) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:48:00] [Epoch 16] train loss = 4.2746
[2025-12-23 01:48:02] [Epoch 16] valid BLEU-4 = 6.08
[2025-12-23 01:48:40] [Epoch 17] train loss = 4.2262
[2025-12-23 01:48:42] [Epoch 17] valid BLEU-4 = 6.69
[2025-12-23 01:48:42] [Checkpoint] Saved best model (BLEU=6.69) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:49:20] [Epoch 18] train loss = 4.1816
[2025-12-23 01:49:22] [Epoch 18] valid BLEU-4 = 6.86
[2025-12-23 01:49:22] [Checkpoint] Saved best model (BLEU=6.86) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:50:01] [Epoch 19] train loss = 4.1400
[2025-12-23 01:50:03] [Epoch 19] valid BLEU-4 = 7.04
[2025-12-23 01:50:03] [Checkpoint] Saved best model (BLEU=7.04) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:50:42] [Epoch 20] train loss = 4.1012
[2025-12-23 01:50:43] [Epoch 20] valid BLEU-4 = 6.68
[2025-12-23 01:51:22] [Epoch 21] train loss = 4.0636
[2025-12-23 01:51:24] [Epoch 21] valid BLEU-4 = 7.86
[2025-12-23 01:51:24] [Checkpoint] Saved best model (BLEU=7.86) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:52:03] [Epoch 22] train loss = 4.0290
[2025-12-23 01:52:04] [Epoch 22] valid BLEU-4 = 7.12
[2025-12-23 01:52:43] [Epoch 23] train loss = 3.9976
[2025-12-23 01:52:45] [Epoch 23] valid BLEU-4 = 7.60
[2025-12-23 01:53:24] [Epoch 24] train loss = 3.9670
[2025-12-23 01:53:26] [Epoch 24] valid BLEU-4 = 7.78
[2025-12-23 01:54:05] [Epoch 25] train loss = 3.9375
[2025-12-23 01:54:06] [Epoch 25] valid BLEU-4 = 7.89
[2025-12-23 01:54:07] [Checkpoint] Saved best model (BLEU=7.89) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:54:45] [Epoch 26] train loss = 3.9110
[2025-12-23 01:54:47] [Epoch 26] valid BLEU-4 = 8.17
[2025-12-23 01:54:47] [Checkpoint] Saved best model (BLEU=8.17) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:55:26] [Epoch 27] train loss = 3.8839
[2025-12-23 01:55:28] [Epoch 27] valid BLEU-4 = 8.22
[2025-12-23 01:55:28] [Checkpoint] Saved best model (BLEU=8.22) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:56:07] [Epoch 28] train loss = 3.8601
[2025-12-23 01:56:08] [Epoch 28] valid BLEU-4 = 8.27
[2025-12-23 01:56:08] [Checkpoint] Saved best model (BLEU=8.27) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:56:47] [Epoch 29] train loss = 3.8368
[2025-12-23 01:56:49] [Epoch 29] valid BLEU-4 = 8.45
[2025-12-23 01:56:49] [Checkpoint] Saved best model (BLEU=8.45) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:57:28] [Epoch 30] train loss = 3.8144
[2025-12-23 01:57:29] [Epoch 30] valid BLEU-4 = 8.53
[2025-12-23 01:57:29] [Checkpoint] Saved best model (BLEU=8.53) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:58:08] [Epoch 31] train loss = 3.7932
[2025-12-23 01:58:10] [Epoch 31] valid BLEU-4 = 8.77
[2025-12-23 01:58:10] [Checkpoint] Saved best model (BLEU=8.77) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:58:49] [Epoch 32] train loss = 3.7726
[2025-12-23 01:58:51] [Epoch 32] valid BLEU-4 = 9.06
[2025-12-23 01:58:51] [Checkpoint] Saved best model (BLEU=9.06) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 01:59:30] [Epoch 33] train loss = 3.7524
[2025-12-23 01:59:31] [Epoch 33] valid BLEU-4 = 9.06
[2025-12-23 02:00:10] [Epoch 34] train loss = 3.7345
[2025-12-23 02:00:11] [Epoch 34] valid BLEU-4 = 9.00
[2025-12-23 02:00:51] [Epoch 35] train loss = 3.7173
[2025-12-23 02:00:53] [Epoch 35] valid BLEU-4 = 8.81
[2025-12-23 02:01:31] [Epoch 36] train loss = 3.6992
[2025-12-23 02:01:33] [Epoch 36] valid BLEU-4 = 9.12
[2025-12-23 02:01:33] [Checkpoint] Saved best model (BLEU=9.12) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 02:02:12] [Epoch 37] train loss = 3.6833
[2025-12-23 02:02:14] [Epoch 37] valid BLEU-4 = 9.23
[2025-12-23 02:02:14] [Checkpoint] Saved best model (BLEU=9.23) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 02:02:52] [Epoch 38] train loss = 3.6670
[2025-12-23 02:02:54] [Epoch 38] valid BLEU-4 = 9.53
[2025-12-23 02:02:55] [Checkpoint] Saved best model (BLEU=9.53) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 02:03:33] [Epoch 39] train loss = 3.6514
[2025-12-23 02:03:35] [Epoch 39] valid BLEU-4 = 9.39
[2025-12-23 02:04:13] [Epoch 40] train loss = 3.6357
[2025-12-23 02:04:15] [Epoch 40] valid BLEU-4 = 9.43
[2025-12-23 02:04:53] [Epoch 41] train loss = 3.6228
[2025-12-23 02:04:55] [Epoch 41] valid BLEU-4 = 9.53
[2025-12-23 02:04:55] [Checkpoint] Saved best model (BLEU=9.53) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 02:05:34] [Epoch 42] train loss = 3.6087
[2025-12-23 02:05:36] [Epoch 42] valid BLEU-4 = 10.20
[2025-12-23 02:05:37] [Checkpoint] Saved best model (BLEU=10.20) to ./checkpoints_trans/transformer_zh_en_best_exp_lr5e-5.pt
[2025-12-23 02:06:16] [Epoch 43] train loss = 3.5950
[2025-12-23 02:06:17] [Epoch 43] valid BLEU-4 = 9.50
[2025-12-23 02:06:56] [Epoch 44] train loss = 3.5822
[2025-12-23 02:06:58] [Epoch 44] valid BLEU-4 = 9.51
[2025-12-23 02:07:36] [Epoch 45] train loss = 3.5700
[2025-12-23 02:07:38] [Epoch 45] valid BLEU-4 = 9.55
[2025-12-23 02:08:17] [Epoch 46] train loss = 3.5574
[2025-12-23 02:08:18] [Epoch 46] valid BLEU-4 = 9.94
[2025-12-23 02:08:57] [Epoch 47] train loss = 3.5451
[2025-12-23 02:08:59] [Epoch 47] valid BLEU-4 = 10.11
[2025-12-23 02:09:38] [Epoch 48] train loss = 3.5331
[2025-12-23 02:09:39] [Epoch 48] valid BLEU-4 = 9.96
[2025-12-23 02:10:18] [Epoch 49] train loss = 3.5224
[2025-12-23 02:10:20] [Epoch 49] valid BLEU-4 = 9.80
[2025-12-23 02:10:59] [Epoch 50] train loss = 3.5113
[2025-12-23 02:11:00] [Epoch 50] valid BLEU-4 = 9.19
[2025-12-23 02:11:00] Loading best checkpoint for test ...
